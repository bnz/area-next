"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{1774:(t,e,a)=>{a.d(e,{HC:()=>f,Ki:()=>s,yA:()=>u});var n=a(5604),o=a(4437),s=function(t){return t.common="common",t.translations="translations",t.features="features",t.posts="posts",t.splits="splits",t}({});let r=Object.values(s),c=n.Ik({id:n.Yj(),title:n.Yj(),subTitle:n.Yj(),image:n.Yj()}),l=n.Ik({id:n.Yj(),title:n.Yj(),excerpt:n.Yj(),image:n.Yj(),slug:n.Yj(),content:n.Yj(),datetime:n.Yj()}),i=n.Ik({id:n.Yj(),title:n.Yj(),description:n.Yj()}),u=n.g1(n.k5(o.U),n.g1(n.k5(r),n.Yj())),d=n.g1(n.Yj(),n.Yj()),f=n.g1(n.k5(o.U),n.Ik({common:d,translations:d,features:n.YO(i),posts:n.YO(l),splits:n.YO(c)}));n.Ik({path:n.Yj(),name:n.Yj()})},4437:(t,e,a)=>{a.d(e,{U:()=>n});let n=["en","lv","ru"]},4903:(t,e,a)=>{a.d(e,{X7:()=>O,BY:()=>K,z8:()=>Y});var n=a(5155),o=a(2115);let s="area-next",r="main";function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/data/").concat(t,".json").concat(e)}var l=a(4134),i=a(6099),u=a(6048),d=a(1774),f=a(9300),p=a.n(f);function m(){let[t,e]=(0,o.useState)(""),[a,s]=(0,o.useState)(!1),{loadFile:r}=Y(d.Ki.common),c=(0,i.s)("button.login"),l=(0,i.s)("password"),f=(0,i.s)("loading");return(0,n.jsx)("div",{className:p()("min-h-[300px] flex items-center justify-center"),children:(0,n.jsxs)("form",{className:"flex max-md:flex-col gap-4 md:max-w-1/2 mx-auto",onSubmit:async function(e){e.preventDefault(),s(!0),await r(t)},children:[(0,n.jsx)("input",{type:"password",placeholder:l,value:t,autoFocus:!0,className:"max-md:text-center min-w-[300px]",onChange:function(t){e(t.target.value)}}),(0,n.jsx)(u.jl,{disabled:a,children:a?f:c})]})})}var g=a(4437),h=a(4052),b=a.n(h),j=a(9231),y=a.n(j);function v(){return(0,n.jsx)("div",{className:"flex items-center justify-center max-lg:min-h-[300px] lg:min-h-[500px]",children:(0,i.s)("loading")})}let k={[d.Ki.common]:"",[d.Ki.translations]:"",[d.Ki.features]:"",[d.Ki.posts]:"",[d.Ki.splits]:""},x={en:k,lv:k,ru:k},C={[d.Ki.common]:{},[d.Ki.translations]:{},[d.Ki.features]:[],[d.Ki.posts]:[],[d.Ki.splits]:[]},S={en:C,lv:C,ru:C},w=(0,o.createContext)({async loadFile(){},logOut(){},loadedData:C,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async loadImagesList(){},imagesList:[],removeFromArrayData(){},saveToLocalStorage(){},areEqual:()=>!1,updateImage(){}});function Y(t){let e=(0,o.useContext)(w);return{...e,...t?{loadFile:a=>e.loadFile(t,a),loadData:()=>e.loadData(t),saveData:a=>e.saveData(t,a),loadedData:e.loadedData[t],updateArrayData:a=>e.updateArrayData(t,a),areEqual:a=>e.areEqual(t,a),...t===d.Ki.posts||t===d.Ki.splits?{updateImage:(a,n)=>e.updateImage(t,a,n)}:{},...t===d.Ki.posts||t===d.Ki.features?{removeFromArrayData:a=>e.removeFromArrayData(t,a)}:{}}:{}}}let I=b()(function(t){try{localStorage.setItem(K,JSON.stringify(t))}catch(t){console.log(t)}},400),K="loaded-data",D="sha-data",N="token";function O(t){let{children:e,lang:a}=t,[i,u]=(0,o.useState)(""),[f,p]=(0,o.useState)(!1),[h,b]=(0,o.useState)(x),[j,k]=(0,o.useState)(S),[C,Y]=(0,o.useState)(S),[O,J]=(0,o.useState)(!1),[F,E]=(0,o.useState)([]);(0,o.useEffect)(function(){try{let t=localStorage.getItem(K);if(t){let e=JSON.parse(t||"{}");k(e)}let e=localStorage.getItem(D);e&&b(d.yA.parse(JSON.parse(e||"{}")))}catch(t){console.log(t)}},[k,b]),(0,o.useEffect)(function(){try{let t=localStorage.getItem(N);null!==t&&u(JSON.parse(t))}catch(t){console.log(t)}},[u]);let z=(0,o.useCallback)(function(t,e){b(function(n){let o=d.yA.parse({...n,[a]:{...n[a],[t]:e}});return localStorage.setItem(D,JSON.stringify(o)),o})},[a,b]),U=(0,o.useCallback)(async function(t,e){try{let n=await fetch(c("".concat(a,"/").concat(t),"?ref=".concat(r)),{headers:{Authorization:"token ".concat(e||i)}}),o=await n.json();if(o.status)return;return e&&(localStorage.setItem(N,JSON.stringify(e)),u(e)),{content:l.hp.from(o.content,"base64").toString("utf8"),sha:o.sha}}catch(t){console.error(t)}},[a,i]),H=(0,o.useCallback)(async function(t,e,a,n){try{let o=l.hp.from(e).toString("base64"),s=await fetch(c("".concat(n,"/").concat(t)),{method:"PUT",headers:{Authorization:"token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(t,".json)"),content:o,sha:a,branch:r})}),u=await s.json();if(s.ok)return{sha:u.content.sha};console.error(u)}catch(t){console.error(t)}},[i,a]),L=(0,o.useCallback)(async function(t){let e=Object.keys(j[a][t]).length>0,n=Object.keys(C[a][t]).length>0;if(!e||!n){p(!0);let o=await U(t);try{if(p(!1),!o)return;e||(k(function(e){let n=d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}});return I(n),n}),z(t,o.sha)),n||Y(function(e){return d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}})})}catch(t){console.log(t)}}},[U,j,C,k,a,Y,p]),P=(0,o.useCallback)(async function(t,e){try{for(let n of(J(!0),e?g.U:[a])){let e=await H(t,JSON.stringify(j[n][t],null,2),h[n][t],n);e&&z(t,e.sha)}J(!1)}catch(t){console.log(t)}},[H,h,j,a,J]),T=(0,o.useCallback)(function(){localStorage.removeItem(N),localStorage.removeItem(K),localStorage.removeItem(D),window.location.reload()},[]),_=(0,o.useCallback)(function(t){return function(e){k(function(n){let o=d.HC.parse({...n,[a]:{...n[a],[d.Ki.translations]:{...n[a][d.Ki.translations],[t]:e.target.value}}});return I(o),o})}},[a,k]),q=(0,o.useCallback)(function(t,e){return function(n){k(function(o){let s=structuredClone(o[a][t]),r=A(s,e);if(r>-1){s[r][n.target.name]=n.target.value;let e=d.HC.parse({...o,[a]:{...o[a],[t]:s}});return I(e),e}return o})}},[a,k]),R=(0,o.useCallback)(async function(t){var e;let a=new FileReader,n=await new Promise(function(e,n){a.onloadend=function(){e(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(t)}),o=(e=t.name,"https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/public/data/images/").concat(e)),c=await fetch(o,{method:"PUT",headers:{Authorization:"token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(o.split("contents")[1]),content:n,branch:r})});if(!c.ok)throw Error("Failed to upload image");return(await c.json()).content.path.replace("public/","/")},[i]),B=(0,o.useCallback)(async function(){E((await (await fetch("https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(i),Accept:"application/vnd.github.v3+json"}})).json()).map(function(t){let{name:e,path:a}=t;return{name:e,path:a.replace("public/","/")}}))},[i,E]),X=(0,o.useCallback)(function(t,e){k(function(a){let n=structuredClone(a);g.U.forEach(function(a){let o=A(n[a][t],e);n[a][t].splice(o,1)});let o=d.HC.parse(n);return I(o),o})},[k,a]),$=(0,o.useCallback)(function(t,e){if(void 0!==e&&(t===d.Ki.features||t===d.Ki.posts||t===d.Ki.splits)){let n=A(C[a][t],e),o=A(j[a][t],e);return y()(C[a][t][n],j[a][t][o])}return y()(C[a][t],j[a][t])},[C,j,a]),G=(0,o.useCallback)(function(t,e,n){k(function(o){let s=structuredClone(o),r=A(s[a][t],e);s[a][t][r].image=n;let c=d.HC.parse(s);return I(c),c})},[k,a]);return(0,n.jsx)(w.Provider,{value:{loadFile:U,logOut:T,loadedData:j[a],setLoadedData:k,loadData:L,saveData:P,updateRecordData:_,updateArrayData:q,lang:a,publishLoading:O,setPublishLoading:J,uploadImage:R,loadImagesList:B,imagesList:F,removeFromArrayData:X,saveToLocalStorage:I,areEqual:$,updateImage:G},children:(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)(v,{}):i?e:(0,n.jsx)(m,{})})})}function A(t,e){return t.findIndex(function(t){let{id:a}=t;return a===e})}},6048:(t,e,a)=>{a.d(e,{$n:()=>r,jl:()=>c,rm:()=>l});var n=a(5155),o=a(9300),s=a.n(o);function r(t){let{children:e,className:a,onClick:o,type:r="button",disabled:c}=t;return(0,n.jsx)("button",{className:s()("button",a),type:r,onClick:o,disabled:c,children:e})}function c(t){let{children:e,className:a,disabled:o}=t;return(0,n.jsx)(r,{type:"submit",className:a,disabled:o,children:e})}function l(t){let{children:e,className:a,onClick:o,disabled:r}=t;return(0,n.jsx)("button",{type:"button",className:s()("cursor-pointer",a),onClick:o,disabled:r,children:e})}},6099:(t,e,a)=>{a.d(e,{I18nProvider:()=>r,s:()=>c});var n=a(5155),o=a(2115);let s=(0,o.createContext)({keys:{},features:[],posts:[],splits:[]});function r(t){let{children:e,translations:a}=t;return(0,n.jsx)(s.Provider,{value:a,children:e})}function c(t){var e,a;let n=(0,o.useContext)(s);return"features"===t||"posts"===t?null!=(e=n[t])?e:"~".concat(t,"~"):null!=(a=n.keys[t])?a:"~".concat(t,"~")}}}]);