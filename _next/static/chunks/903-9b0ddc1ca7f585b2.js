"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{1774:(t,e,a)=>{a.d(e,{HC:()=>p,Ki:()=>s,yA:()=>u});var n=a(5604),o=a(4437),s=function(t){return t.common="common",t.translations="translations",t.features="features",t.posts="posts",t.splits="splits",t}({});let c=Object.values(s),r=n.Ik({id:n.Yj(),title:n.Yj(),subTitle:n.Yj(),image:n.Yj()}),l=n.Ik({id:n.Yj(),title:n.Yj(),excerpt:n.Yj(),image:n.Yj(),slug:n.Yj(),content:n.Yj(),datetime:n.Yj()}),i=n.Ik({id:n.Yj(),title:n.Yj(),description:n.Yj()}),u=n.g1(n.k5(o.U),n.g1(n.k5(c),n.Yj())),d=n.g1(n.Yj(),n.Yj()),p=n.g1(n.k5(o.U),n.Ik({common:d,translations:d,features:n.YO(i),posts:n.YO(l),splits:n.YO(r)}));n.Ik({path:n.Yj(),name:n.Yj()})},4437:(t,e,a)=>{a.d(e,{U:()=>n});let n=["en","lv","ru"]},4903:(t,e,a)=>{a.d(e,{X7:()=>J,BY:()=>K,k8:()=>A,CV:()=>O,z8:()=>Y});var n=a(5155),o=a(2115);let s="area-next",c="main";function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/data/").concat(t,".json").concat(e)}var l=a(4134),i=a(6099),u=a(6048),d=a(1774),p=a(306),f=a(4416),m=a(7134);function g(){let[t,e]=(0,o.useState)(""),[a,s]=(0,o.useState)(!1),[c,r]=(0,o.useState)(!1),{loadFile:l}=Y(d.Ki.common),g=(0,i.s)("button.login"),h=(0,i.s)("password"),b=(0,i.s)("loading");return(0,n.jsxs)("div",{className:"min-h-[300px] flex flex-col items-center justify-center",children:[(0,n.jsxs)("form",{className:"flex max-md:flex-col gap-4 md:max-w-1/2 mx-auto",onSubmit:async function(e){e.preventDefault(),r(!1),s(!0);try{await l(t)||(s(!1),r(!0))}catch(t){console.error(t),s(!1)}},children:[(0,n.jsx)("input",{type:"password",placeholder:h,value:t,autoFocus:!0,className:"max-md:text-center min-w-[300px]",onChange:function(t){e(t.target.value)}}),(0,n.jsxs)(u.jl,{disabled:a,className:"icon",children:[a?b:g,(0,n.jsx)(p.A,{})]}),(0,n.jsxs)(u.$n,{className:"icon",onClick:function(){localStorage.removeItem(O),localStorage.removeItem(K),localStorage.removeItem(A),(0,m.i)({active:!1}),window.location.reload()},children:[(0,n.jsx)(f.A,{}),(0,n.jsx)("span",{children:(0,i.s)("button.close")})]})]}),(0,n.jsx)("div",{className:"py-3 text-red-500 h-10 ",children:c?"Error!":" "})]})}var h=a(4437),b=a(4052),y=a.n(b),j=a(9231),v=a.n(j),x=a(4631);function S(){return(0,n.jsxs)("div",{className:"flex flex-col gap-3 items-center justify-center max-lg:min-h-[300px] lg:min-h-[500px]",children:[(0,n.jsx)(x.A,{size:50,className:"text-indigo-800 animate-spin origin-center [animation-duration:3s]"}),(0,n.jsx)("div",{children:(0,i.s)("loading")})]})}let k={[d.Ki.common]:"",[d.Ki.translations]:"",[d.Ki.features]:"",[d.Ki.posts]:"",[d.Ki.splits]:""},C={en:k,lv:k,ru:k},w={[d.Ki.common]:{},[d.Ki.translations]:{},[d.Ki.features]:[],[d.Ki.posts]:[],[d.Ki.splits]:[]},I={en:w,lv:w,ru:w},N=(0,o.createContext)({async loadFile(){},logOut(){},loadedData:w,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async loadImagesList(){},imagesList:[],removeFromArrayData(){},saveToLocalStorage(){},areEqual:()=>!1,updateImage(){},checkStatus:async()=>!1,availableStatus:!1,setAvailableStatus(){}});function Y(t){let e=(0,o.useContext)(N);return{...e,...t?{loadFile:a=>e.loadFile(t,a),loadData:()=>e.loadData(t),saveData:a=>e.saveData(t,a),loadedData:e.loadedData[t],updateArrayData:a=>e.updateArrayData(t,a),areEqual:a=>e.areEqual(t,a),...t===d.Ki.posts||t===d.Ki.splits?{updateImage:(a,n)=>e.updateImage(t,a,n)}:{},...t===d.Ki.posts||t===d.Ki.features?{removeFromArrayData:a=>e.removeFromArrayData(t,a)}:{}}:{}}}let D=y()(function(t){try{localStorage.setItem(K,JSON.stringify(t))}catch(t){console.log(t)}},400),K="loaded-data",A="sha-data",O="token";function J(t){let{children:e,lang:a}=t,[i,u]=(0,o.useState)(""),[p,f]=(0,o.useState)(!1),[m,b]=(0,o.useState)(C),[y,j]=(0,o.useState)(I),[x,k]=(0,o.useState)(I),[w,Y]=(0,o.useState)(!1),[J,E]=(0,o.useState)([]),[F,H]=(0,o.useState)(!1);(0,o.useEffect)(function(){try{let t=localStorage.getItem(K);if(t){let e=JSON.parse(t||"{}");j(e)}let e=localStorage.getItem(A);e&&b(d.yA.parse(JSON.parse(e||"{}")))}catch(t){console.log(t)}},[j,b]),(0,o.useEffect)(function(){try{let t=localStorage.getItem(O);null!==t&&u(JSON.parse(t))}catch(t){console.log(t)}},[u]);let L=(0,o.useCallback)(function(t,e){b(function(n){let o=d.yA.parse({...n,[a]:{...n[a],[t]:e}});return localStorage.setItem(A,JSON.stringify(o)),o})},[a,b]),P=(0,o.useCallback)(async function(t,e){try{let n=await fetch(r("".concat(a,"/").concat(t),"?ref=".concat(c)),{headers:{Authorization:"token ".concat(e||i)}}),o=await n.json();if(o.status)return;return e&&(localStorage.setItem(O,JSON.stringify(e)),u(e)),{content:l.hp.from(o.content,"base64").toString("utf8"),sha:o.sha}}catch(t){console.error(t)}},[a,i]),U=(0,o.useCallback)(async function(t,e,a,n){try{let o=l.hp.from(e).toString("base64"),s=await fetch(r("".concat(n,"/").concat(t)),{method:"PUT",headers:{Authorization:"token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(t,".json)"),content:o,sha:a,branch:c})}),u=await s.json();if(s.ok)return{sha:u.content.sha};console.error(u)}catch(t){console.error(t)}},[i]),_=(0,o.useCallback)(async function(t){let e=Object.keys(y[a][t]).length>0,n=Object.keys(x[a][t]).length>0;if(!e||!n){f(!0);let o=await P(t);try{if(f(!1),!o)return;e||(j(function(e){let n=d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}});return D(n),n}),L(t,o.sha)),n||k(function(e){return d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}})})}catch(t){console.log(t)}}},[P,y,x,j,a,k,f,L]),T=(0,o.useCallback)(async function(t,e){try{for(let n of(H(!1),Y(!0),e?h.U:[a])){let e=await U(t,JSON.stringify(y[n][t],null,2),m[n][t],n);e&&L(t,e.sha)}Y(!1)}catch(t){console.log(t)}},[U,m,y,a,Y,H,L]),q=(0,o.useCallback)(function(){localStorage.removeItem(O),localStorage.removeItem(K),localStorage.removeItem(A),window.location.reload()},[]),R=(0,o.useCallback)(function(t){return function(e){j(function(n){let o=d.HC.parse({...n,[a]:{...n[a],[d.Ki.translations]:{...n[a][d.Ki.translations],[t]:e.target.value}}});return D(o),o})}},[a,j]),B=(0,o.useCallback)(function(t,e){return function(n){j(function(o){let s=structuredClone(o[a][t]),c=z(s,e);if(c>-1){s[c][n.target.name]=n.target.value;let e=d.HC.parse({...o,[a]:{...o[a],[t]:s}});return D(e),e}return o})}},[a,j]),$=(0,o.useCallback)(async function(t){var e;let a=new FileReader,n=await new Promise(function(e,n){a.onloadend=function(){e(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(t)}),o=(e=t.name,"https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/public/data/images/").concat(e)),r=await fetch(o,{method:"PUT",headers:{Authorization:"token ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(o.split("contents")[1]),content:n,branch:c})});if(!r.ok)throw Error("Failed to upload image");return(await r.json()).content.path.replace("public/","/")},[i]),G=(0,o.useCallback)(async function(){E((await (await fetch("https://api.github.com/repos/".concat("bnz","/").concat(s,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(i),Accept:"application/vnd.github.v3+json"}})).json()).map(function(t){let{name:e,path:a}=t;return{name:e,path:a.replace("public/","/")}}))},[i,E]),V=(0,o.useCallback)(function(t,e){j(function(a){let n=structuredClone(a);h.U.forEach(function(a){let o=z(n[a][t],e);n[a][t].splice(o,1)});let o=d.HC.parse(n);return D(o),o})},[j]),X=(0,o.useCallback)(function(t,e){if(void 0!==e&&(t===d.Ki.features||t===d.Ki.posts||t===d.Ki.splits)){let n=z(x[a][t],e),o=z(y[a][t],e);return v()(x[a][t][n],y[a][t][o])}return v()(x[a][t],y[a][t])},[x,y,a]),M=(0,o.useCallback)(function(t,e,n){j(function(o){let s=structuredClone(o),c=z(s[a][t],e);s[a][t][c].image=n;let r=d.HC.parse(s);return D(r),r})},[j,a]),Q=(0,o.useCallback)(async function(){let t=await fetch("https://api.github.com/repos/".concat("bnz","/").concat(s,"/actions/runs?per_page=1"),{headers:{Authorization:"token ".concat(i)}}),e=await t.json();if(e.workflow_runs.length>0){let{status:t,name:a,conclusion:n}=e.workflow_runs[0];return["pages build and deployment","Deploy to GitHub Pages"].includes(a),"pages build and deployment"===a&&"completed"===t}return!1},[i]);return(0,n.jsx)(N.Provider,{value:{loadFile:P,logOut:q,loadedData:y[a],setLoadedData:j,loadData:_,saveData:T,updateRecordData:R,updateArrayData:B,lang:a,publishLoading:w,setPublishLoading:Y,uploadImage:$,loadImagesList:G,imagesList:J,removeFromArrayData:V,saveToLocalStorage:D,areEqual:X,updateImage:M,checkStatus:Q,availableStatus:F,setAvailableStatus:H},children:(0,n.jsx)(n.Fragment,{children:p?(0,n.jsx)(S,{}):i?e:(0,n.jsx)(g,{})})})}function z(t,e){return t.findIndex(function(t){let{id:a}=t;return a===e})}},6048:(t,e,a)=>{a.d(e,{$n:()=>c,jl:()=>r,rm:()=>l});var n=a(5155),o=a(9300),s=a.n(o);function c(t){let{children:e,className:a,onClick:o,type:c="button",disabled:r}=t;return(0,n.jsx)("button",{className:s()("button",a),type:c,onClick:o,disabled:r,children:e})}function r(t){let{children:e,className:a,disabled:o}=t;return(0,n.jsx)(c,{type:"submit",className:a,disabled:o,children:e})}function l(t){let{children:e,className:a,onClick:o,disabled:c}=t;return(0,n.jsx)("button",{type:"button",className:s()("cursor-pointer",a),onClick:o,disabled:c,children:e})}},6099:(t,e,a)=>{a.d(e,{I18nProvider:()=>c,s:()=>r});var n=a(5155),o=a(2115);let s=(0,o.createContext)({keys:{},features:[],posts:[],splits:[]});function c(t){let{children:e,translations:a}=t;return(0,n.jsx)(s.Provider,{value:a,children:e})}function r(t){var e,a;let n=(0,o.useContext)(s);return"features"===t||"posts"===t?null!=(e=n[t])?e:"~".concat(t,"~"):null!=(a=n.keys[t])?a:"~".concat(t,"~")}},7134:(t,e,a)=>{function n(){let t={};try{let e=localStorage.getItem("admin");null!==e&&(t=JSON.parse(e))}catch(t){console.log(t)}return t}function o(t){let e=n();try{localStorage.setItem("admin",JSON.stringify({...e,...t}))}catch(t){console.log(t)}}a.d(e,{L:()=>n,i:()=>o})}}]);