(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{799:(e,t,n)=>{Promise.resolve().then(n.bind(n,8894))},6099:(e,t,n)=>{"use strict";n.d(t,{I18nProvider:()=>o,s:()=>r});var a=n(5155),s=n(2115);let l=(0,s.createContext)({keys:{},features:[],posts:[]});function o(e){let{children:t,translations:n}=e;return(0,a.jsx)(l.Provider,{value:n,children:t})}function r(e){var t,n;let a=(0,s.useContext)(l);return"features"===e||"posts"===e?null!=(t=a[e])?t:"~".concat(e,"~"):null!=(n=a.keys[e])?n:"~".concat(e,"~")}},8894:(e,t,n)=>{"use strict";n.d(t,{Login:()=>M});var a=n(5155),s=n(2115);let l="area-next",o="main";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/data/").concat(e,".json").concat(t)}var c=n(4134),i=n(6099);function u(){let[e,t]=(0,s.useState)(""),[n,l]=(0,s.useState)(!1),{loadFile:o}=j(),r=(0,i.s)("button.login"),c=(0,i.s)("password"),u=(0,i.s)("loading");return(0,a.jsx)("div",{className:"max-w-lg mx-auto py-36",children:(0,a.jsxs)("form",{className:"flex gap-4",onSubmit:async function(t){t.preventDefault(),l(!0),await o(p.common,e)},children:[(0,a.jsx)("input",{type:"password",placeholder:c,value:e,autoFocus:!0,onChange:function(e){t(e.target.value)}}),(0,a.jsx)("button",{disabled:n,type:"submit",className:"button",children:n?u:r})]})})}var d=n(4052),f=n.n(d),p=function(e){return e.common="common",e.translations="translations",e.features="features",e.posts="posts",e}({});let x={common:"",translations:"",features:"",posts:""},m={en:x,lv:x,ru:x},h={common:{},translations:{},features:[],posts:[]},b={en:h,lv:h,ru:h},g=(0,s.createContext)({async loadFile(){},async publishData(){},logOut(){},loadedData:h,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async getImagesList(){},removeFromArrayData(){}});function j(){return(0,s.useContext)(g)}let y="loaded-data",v="sha-data",N="token";function C(e){let{children:t,lang:n}=e,d=(0,i.s)("loading"),[p,x]=(0,s.useState)(""),[h,j]=(0,s.useState)(!1),[C,k]=(0,s.useState)(m),[S,w]=(0,s.useState)(b),[O,I]=(0,s.useState)(!1);(0,s.useEffect)(function(){try{let e=localStorage.getItem(y);e&&w(JSON.parse(e||"{}"));let t=localStorage.getItem(v);t&&k(JSON.parse(t||"{}"))}catch(e){console.log(e)}},[w,k]),(0,s.useEffect)(function(){try{let e=localStorage.getItem(N);null!==e&&x(JSON.parse(e))}catch(e){console.log(e)}},[x]);let E=(0,s.useCallback)(function(e,t){k(function(a){let s={...a,[n]:{...a[n],[e]:t}};return localStorage.setItem(v,JSON.stringify(s)),s})},[n]),F=(0,s.useCallback)(async function(e,t){try{let a=await fetch(r("".concat(n,"/").concat(e),"?ref=".concat(o)),{headers:{Authorization:"token ".concat(t||p)}}),s=await a.json();if(s.status)return;return t&&(localStorage.setItem(N,JSON.stringify(t)),x(t)),{content:c.hp.from(s.content,"base64").toString("utf8"),sha:s.sha}}catch(e){console.error(e)}},[n,j,p]),J=(0,s.useCallback)(async function(e,t,a){try{let s=c.hp.from(t).toString("base64"),l=await fetch(r("".concat(n,"/").concat(e)),{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(e,".json)"),content:s,sha:a,branch:o})}),i=await l.json();if(l.ok)return{sha:i.content.sha};console.error(i)}catch(e){console.error(e)}},[p,n]),D=(0,s.useCallback)(async function(e){if(Object.keys(S[n][e]).length>0)return;let t=await F(e);if(t)try{w(function(a){let s={...a,[n]:{...a[n],[e]:JSON.parse(t.content)}};return localStorage.setItem(y,JSON.stringify(s)),s}),E(e,t.sha)}catch(e){console.log(e)}},[F,S,w,n]),z=(0,s.useCallback)(async function(e){try{I(!0);let t=await J(e,JSON.stringify(S[n][e],null,2),C[n][e]);t&&E(e,t.sha),I(!1)}catch(e){console.log(e)}},[J,C,S,n,I]),V=(0,s.useCallback)(function(){localStorage.removeItem(N),localStorage.removeItem(y),localStorage.removeItem(v),window.location.reload()},[]),L=f()(function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}},400),P=(0,s.useCallback)(function(e){return function(t){w(function(a){let s={...a,[n]:{...a[n],translations:{...a[n].translations,[e]:t.target.value}}};return L(y,s),s})}},[n,L,w]),A=(0,s.useCallback)(function(e,t){return function(a){w(function(s){let l=structuredClone(s[n][e]);l[t][a.target.name]=a.target.value;let o={...s,[n]:{...s[n],[e]:l}};return L(y,o),o})}},[n,L,w]),R=(0,s.useCallback)(async function(e){var t;let n=new FileReader,a=await new Promise((t,a)=>{n.onloadend=()=>{t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)}),s=(t=e.name,"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/public/data/images/").concat(t)),r=await fetch(s,{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(s.split("contents")[1]),content:a,branch:o})});if(!r.ok)throw Error("Failed to upload image");return(await r.json()).content.path.replace("public/","/")},[p]),_=(0,s.useCallback)(async function(){return await (await fetch("https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(p),Accept:"application/vnd.github.v3+json"}})).json()},[p]),U=(0,s.useCallback)(function(e,t){w(function(a){let s=structuredClone(a);return s[n][e].splice(t,1),L(y,s),s})},[w,n]);return(0,a.jsx)(g.Provider,{value:{loadFile:F,publishData:J,logOut:V,loadedData:S[n],setLoadedData:w,loadData:D,saveData:z,updateRecordData:P,updateArrayData:A,lang:n,publishLoading:O,setPublishLoading:I,uploadImage:R,getImagesList:_,removeFromArrayData:U},children:h?(0,a.jsx)("div",{className:"max-w-lg mx-auto flex items-center justify-center min-h-48",children:d}):p?t:(0,a.jsx)(u,{})})}var k=n(5739);function S(e){let{filename:t}=e,{saveData:n,publishLoading:s}=j(),l=(0,i.s)("loading");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:async function(){await n(t)},children:(0,i.s)("button.publish")})}),s&&(0,a.jsx)("div",{className:"absolute -inset-1 bg-gray-100/90 dark:bg-gray-700/90 rounded flex items-center justify-center",children:l})]})}function w(){let{loadedData:e,loadData:t,saveData:n,updateRecordData:l,publishLoading:o}=j(),r=(0,i.s)("loading");(0,s.useEffect)(function(){t(p.translations)},[]);let c=e[p.translations];return 0===Object.keys(c).length?(0,a.jsx)(a.Fragment,{children:r}):(0,a.jsxs)("div",{className:"flex flex-col gap-3 relative",children:[Object.keys(c).map(function(e){return(0,a.jsxs)("label",{children:[(0,a.jsx)("div",{className:"text-xs font-sans",children:e}),(0,a.jsx)("textarea",{rows:1,defaultValue:c[e],onChange:l(e)})]},e)}),(0,a.jsx)(S,{filename:p.translations})]})}function O(){let{logOut:e}=j(),t=(0,i.s)("button.logout"),n=(0,i.s)("welcome");return(0,a.jsxs)("div",{className:"flex flex-row gap-3 mb-3 px-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"button ml-auto",onClick:e,children:t})]})}function I(){let e=(0,i.s)("label.title"),t=(0,i.s)("label.description"),{loadedData:n,updateArrayData:l,removeFromArrayData:o,loadData:r}=j();return(0,s.useEffect)(function(){r(p.features)},[r]),n[p.features].map(function(n,s){let{title:r,description:c}=n,i=l(p.features,s);return(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_35px] gap-3 outline-1 outline-gray-300 dark:outline-gray-700 mb-5 p-2 rounded",children:[(0,a.jsx)("input",{type:"text",defaultValue:r,placeholder:e,name:"title",onChange:i}),(0,a.jsx)("div",{className:"row-span-2 flex items-center justify-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:function(){o(p.features,s)},children:"X"})}),(0,a.jsx)("textarea",{rows:1,placeholder:t,defaultValue:c,name:"description",onChange:i})]},s)})}function E(){let e=(0,i.s)("button.add"),t=(0,i.s)("label.title"),n=(0,i.s)("label.description"),l=(0,i.s)("button.cancel"),o=(0,i.s)("button.save"),[r,c]=(0,s.useState)(!1),{setLoadedData:u,lang:d}=j(),[f,x]=(0,s.useState)({title:"",description:""}),m=(0,s.useCallback)(function(e){x(function(t){return{...t,[e.target.name]:e.target.value}})},[x]),h=(0,s.useCallback)(function(){c(!1)},[c]),b=(0,s.useCallback)(function(){c(!0)},[c]);return r?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:function(e){e.preventDefault(),u(function(e){let t={...e,[d]:{...e[d],[p.features]:[...e[d][p.features],f]}};return localStorage.setItem(y,JSON.stringify(t)),t}),h()},children:[(0,a.jsx)("input",{type:"text",name:"title",placeholder:t,autoFocus:!0,defaultValue:f.title,onChange:m}),(0,a.jsx)("textarea",{rows:1,placeholder:n,defaultValue:f.description,name:"description",onChange:m}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:o}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:h,children:l})]})]}):(0,a.jsx)("button",{className:"button",type:"button",onClick:b,children:e})}function F(){return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(I,{})}),(0,a.jsx)("div",{className:"py-3 border-t border-gray-300 dark:border-gray-700",children:(0,a.jsx)(E,{})}),(0,a.jsx)(S,{filename:p.features})]})}var J=n(5695);function D(e){let{name:t,onChange:n,defaultValue:l}=e,o=(0,s.useRef)(null);return(0,a.jsx)("input",{type:"datetime-local",ref:o,onClick:function(){var e,t;null==(t=o.current)||null==(e=t.showPicker)||e.call(t)},className:"cursor-pointer",name:t,onChange:n,defaultValue:l})}let z={slug:"",title:"",image:"",excerpt:"",content:"",datetime:""};function V(){let e=(0,i.s)("button.add"),t=(0,i.s)("button.cancel"),n=(0,i.s)("button.save"),l=(0,i.s)("label.url"),o=(0,i.s)("label.title"),r=(0,i.s)("label.excerpt"),c=(0,i.s)("label.content"),{setLoadedData:u,lang:d}=j(),[f,x]=(0,s.useState)(!1),[m,h]=(0,s.useState)(z),b=(0,s.useCallback)(function(){x(!0)},[x]),g=(0,s.useCallback)(function(){x(!1),h(z)},[x,h]),v=(0,s.useCallback)(function(e){h(function(t){return{...t,[e.target.name]:e.target.value}})},[h]),N=(0,s.useCallback)(function(e){e.preventDefault(),u(function(e){let t={...e,[d]:{...e[d],[p.posts]:[...e[d][p.posts],m]}};return localStorage.setItem(y,JSON.stringify(t)),t}),g()},[g,u,d,m]);return f?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:N,children:[(0,a.jsx)("input",{autoFocus:!0,type:"text",placeholder:l,name:"slug",onChange:v}),(0,a.jsx)("input",{type:"text",placeholder:o,name:"title",onChange:v}),(0,a.jsx)(D,{name:"datetime",onChange:v}),(0,a.jsx)("input",{type:"text",placeholder:r,name:"excerpt",onChange:v}),(0,a.jsx)("textarea",{placeholder:c,name:"content",onChange:v}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:n}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:g,children:t})]})]}):(0,a.jsx)("button",{type:"button",className:"button",onClick:b,children:e})}function L(e){let{index:t}=e,{uploadImage:n,updateArrayData:l}=j(),[o,r]=(0,s.useState)(null),[c,i]=(0,s.useState)(null),[u,d]=(0,s.useState)("");async function f(){if(c){d("Loading...");try{let e=await n(c);l(p.posts,t)({target:{name:"image",value:e}}),d("Uploaded: /".concat(e))}catch(e){console.error(e),d("Upload failed")}}}return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];if(n){i(n);let e=new FileReader;e.onloadend=()=>r(e.result),e.readAsDataURL(n)}}}),o&&(0,a.jsx)("img",{src:o,alt:"preview",className:"w-full max-w-sm rounded border"}),(0,a.jsx)("button",{onClick:f,disabled:!c,className:"bg-emerald-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Загрузить"}),u&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:u})]})}var P=n(9300),A=n.n(P);function R(e){let{open:t,onClose:n,children:l,maxWidth:o="max-w-4xl"}=e,r=(0,s.useRef)(null);return(0,s.useEffect)(function(){let e=r.current;e&&(t&&!e.open?e.showModal():!t&&e.open&&e.close())},[t]),(0,s.useEffect)(function(){let e=r.current;if(e)return e.addEventListener("close",t),function(){e.removeEventListener("close",t)};function t(){return n()}},[n]),(0,a.jsxs)("dialog",{ref:r,className:A()("dark:backdrop:bg-black/50 backdrop:bg-white/50 rounded-lg p-6 w-full absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 shadow","bg-gray-100 dark:bg-gray-700",o),children:[(0,a.jsx)("button",{className:"absolute right-0 top-0 cursor-pointer",onClick:n,children:(0,i.s)("button.close")}),(0,a.jsx)("div",{children:l})]})}function _(e){let{index:t,filename:n,onClose:l}=e,{getImagesList:o,setLoadedData:r,lang:c}=j(),[i,u]=(0,s.useState)([]);return(0,s.useEffect)(function(){!async function(){u((await o()).map(function(e){let{name:t,path:n}=e;return{name:t,path:n.replace("public/","/")}}))}()},[o,u]),(0,a.jsx)("div",{className:"flex gap-3",children:i.map(function(e,s){let{name:o,path:i}=e;return(0,a.jsx)("img",{src:i,alt:"",className:"w-40 h-40 object-cover rounded cursor-pointer",onClick:function(){r(function(e){let a=structuredClone(e);return a[c][n][t].image=i,localStorage.setItem(y,JSON.stringify(a)),a}),l()}},s)})})}function U(e){let{image:t,index:n}=e,l=(0,i.s)("button.delete"),o=(0,i.s)("button.replace"),r=(0,i.s)("label.or"),c=(0,i.s)("button.choose"),{setLoadedData:u,lang:d}=j(),[f,x]=(0,s.useState)(-1),m=(0,s.useCallback)(function(){x(n)},[x,n]),h=(0,s.useCallback)(function(){x(-1)},[x]),b=(0,s.useCallback)(function(e){return function(){u(function(t){let n=structuredClone(t);return n[d][p.posts][e].image="",localStorage.setItem(y,JSON.stringify(n)),n})}},[d,u]);return(0,a.jsxs)(a.Fragment,{children:[""!==t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:t,alt:"",className:"rounded max-w-[200px]"}),(0,a.jsxs)("div",{className:"flex gap-3 p-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:b(n),children:l}),(0,a.jsx)("button",{type:"button",className:"button",onClick:m,children:o})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L,{index:n}),(0,a.jsx)("div",{children:r}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",className:"button",onClick:m,children:c})})]}),f>-1&&(0,a.jsx)(R,{open:!0,onClose:h,children:(0,a.jsx)(_,{index:f,filename:p.posts,onClose:h})})]})}function T(e){let{index:t}=e,n=(0,i.s)("areYouSure"),l=(0,i.s)("button.cancel"),o=(0,i.s)("button.delete"),{removeFromArrayData:r}=j(),[c,u]=(0,s.useState)(-1),d=(0,s.useCallback)(function(){u(-1)},[u]),f=(0,s.useCallback)(function(){r(p.posts,t),u(-1)},[t,r,u]),x=(0,s.useCallback)(function(){u(t)},[t,u]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:x,children:"X"}),c>-1&&(0,a.jsxs)(R,{maxWidth:"max-w-xl",open:!0,onClose:d,children:[(0,a.jsx)("h5",{className:"text-gray-800 dark:text-gray-100 text-center p-5",children:n}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:d,children:l}),(0,a.jsx)("button",{type:"button",className:"button",onClick:f,children:o})]})]})]})}function K(){let e=(0,i.s)("label.url"),t=(0,i.s)("label.title"),n=(0,i.s)("label.excerpt"),l=(0,i.s)("label.content"),{loadedData:o,updateArrayData:r,loadData:c}=j();return(0,s.useEffect)(function(){c(p.posts)},[]),o[p.posts].map(function(s,o){let{slug:c,title:i,image:u,excerpt:d,content:f,datetime:x}=s,m=r(p.posts,o);return(0,a.jsxs)("div",{className:"grid grid-cols-[2fr_1fr] gap-3 border-b border-gray-200 dark:border-gray-800 py-6 mb-3",children:[(0,a.jsx)("input",{type:"text",placeholder:e,defaultValue:c,name:"slug",onChange:m}),(0,a.jsxs)("div",{className:"rounded row-span-4 flex",children:[(0,a.jsx)("div",{className:"flex-1 pr-5",children:(0,a.jsx)(U,{image:u,index:o})}),(0,a.jsx)("div",{children:(0,a.jsx)(T,{index:o})})]}),(0,a.jsx)("input",{type:"text",placeholder:t,defaultValue:i,name:"title",onChange:m}),(0,a.jsx)(D,{name:"datetime",onChange:m,defaultValue:x}),(0,a.jsx)("input",{type:"text",placeholder:n,defaultValue:d,name:"excerpt",onChange:m}),(0,a.jsx)("textarea",{placeholder:l,defaultValue:f,name:"content",onChange:m})]},o)})}function X(){return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(K,{}),(0,a.jsx)(V,{}),(0,a.jsx)(S,{filename:p.posts})]})}function B(){let e=(0,J.useSearchParams)(),t=(0,J.useRouter)(),n=e.get("tab"),l=n?parseInt(n,10):0,[o,r]=(0,s.useState)(l);return(0,s.useEffect)(function(){history.replaceState(null,"","?tab=".concat(o))},[o,t]),(0,a.jsxs)("div",{className:"max-w-5xl bg-gray-100 dark:bg-gray-700 rounded px-1 py-3 lg:px-3 mx-2 lg:mx-auto shadow",children:[(0,a.jsx)(O,{}),(0,a.jsxs)(k.fu,{selectedIndex:o,onChange:r,className:"px-2",children:[(0,a.jsxs)(k.wb,{className:"flex gap-4 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded overflow-auto scrollbar-hide",children:[(0,a.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.translations")}),(0,a.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.features")}),(0,a.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.posts")}),(0,a.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.contacts")})]}),(0,a.jsxs)(k.T2,{className:"mt-3 py-3",children:[(0,a.jsx)(k.Kp,{children:(0,a.jsx)(w,{})}),(0,a.jsx)(k.Kp,{children:(0,a.jsx)(F,{})}),(0,a.jsx)(k.Kp,{children:(0,a.jsx)(X,{})}),(0,a.jsx)(k.Kp,{children:"contacts tab content"})]})]})]})}function M(e){let{lang:t}=e;return(0,a.jsx)(C,{lang:t,children:(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(B,{})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[114,441,684,358],()=>t(799)),_N_E=e.O()}]);