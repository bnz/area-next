(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{799:(e,t,n)=>{Promise.resolve().then(n.bind(n,5371))},5371:(e,t,n)=>{"use strict";n.d(t,{Login:()=>z});var a=n(5155),s=n(6593),l=n(5739),o=n(2115),r=n(6099);function c(e){let{filename:t}=e,{saveData:n,publishLoading:l}=(0,s.z8)(),o=(0,r.s)("loading");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:async function(){await n(t)},children:(0,r.s)("button.publish")})}),l&&(0,a.jsx)("div",{className:"absolute -inset-1 bg-gray-100/90 dark:bg-gray-700/90 rounded flex items-center justify-center",children:o})]})}function i(){let{loadedData:e,loadData:t,saveData:n,updateRecordData:l,publishLoading:i}=(0,s.z8)(),u=(0,r.s)("loading");(0,o.useEffect)(function(){t(s.Ki.translations)},[]);let d=e[s.Ki.translations];return 0===Object.keys(d).length?(0,a.jsx)(a.Fragment,{children:u}):(0,a.jsxs)("div",{className:"flex flex-col gap-3 relative",children:[Object.keys(d).map(function(e){return(0,a.jsxs)("label",{children:[(0,a.jsx)("div",{className:"text-xs font-sans",children:e}),(0,a.jsx)("textarea",{rows:1,defaultValue:d[e],onChange:l(e)})]},e)}),(0,a.jsx)(c,{filename:s.Ki.translations})]})}function u(){let{logOut:e}=(0,s.z8)(),t=(0,r.s)("button.logout"),n=(0,r.s)("welcome");return(0,a.jsxs)("div",{className:"flex flex-row gap-3 mb-3 px-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"button ml-auto",onClick:e,children:t})]})}function d(){let e=(0,r.s)("label.title"),t=(0,r.s)("label.description"),{loadedData:n,updateArrayData:l,removeFromArrayData:c,loadData:i}=(0,s.z8)();return(0,o.useEffect)(function(){i(s.Ki.features)},[i]),n[s.Ki.features].map(function(n,o){let{title:r,description:i}=n,u=l(s.Ki.features,o);return(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_35px] gap-3 outline-1 outline-gray-300 dark:outline-gray-700 mb-5 p-2 rounded",children:[(0,a.jsx)("input",{type:"text",defaultValue:r,placeholder:e,name:"title",onChange:u}),(0,a.jsx)("div",{className:"row-span-2 flex items-center justify-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:function(){c(s.Ki.features,o)},children:"X"})}),(0,a.jsx)("textarea",{rows:1,placeholder:t,defaultValue:i,name:"description",onChange:u})]},o)})}function f(){let e=(0,r.s)("button.add"),t=(0,r.s)("label.title"),n=(0,r.s)("label.description"),l=(0,r.s)("button.cancel"),c=(0,r.s)("button.save"),[i,u]=(0,o.useState)(!1),{setLoadedData:d,lang:f}=(0,s.z8)(),[p,x]=(0,o.useState)({title:"",description:""}),m=(0,o.useCallback)(function(e){x(function(t){return{...t,[e.target.name]:e.target.value}})},[x]),h=(0,o.useCallback)(function(){u(!1)},[u]),b=(0,o.useCallback)(function(){u(!0)},[u]);return i?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:function(e){e.preventDefault(),d(function(e){let t={...e,[f]:{...e[f],[s.Ki.features]:[...e[f][s.Ki.features],p]}};return localStorage.setItem(s.BY,JSON.stringify(t)),t}),h()},children:[(0,a.jsx)("input",{type:"text",name:"title",placeholder:t,autoFocus:!0,defaultValue:p.title,onChange:m}),(0,a.jsx)("textarea",{rows:1,placeholder:n,defaultValue:p.description,name:"description",onChange:m}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:c}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:h,children:l})]})]}):(0,a.jsx)("button",{className:"button",type:"button",onClick:b,children:e})}function p(){return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"mb-5",children:(0,a.jsx)(d,{})}),(0,a.jsx)("div",{className:"py-3 border-t border-gray-300 dark:border-gray-700",children:(0,a.jsx)(f,{})}),(0,a.jsx)(c,{filename:s.Ki.features})]})}var x=n(5695);function m(e){let{name:t,onChange:n,defaultValue:s}=e,l=(0,o.useRef)(null);return(0,a.jsx)("input",{type:"datetime-local",ref:l,onClick:function(){var e,t;null==(t=l.current)||null==(e=t.showPicker)||e.call(t)},className:"cursor-pointer",name:t,onChange:n,defaultValue:s})}let h={slug:"",title:"",image:"",excerpt:"",content:"",datetime:""};function b(){let e=(0,r.s)("button.add"),t=(0,r.s)("button.cancel"),n=(0,r.s)("button.save"),l=(0,r.s)("label.url"),c=(0,r.s)("label.title"),i=(0,r.s)("label.excerpt"),u=(0,r.s)("label.content"),{setLoadedData:d,lang:f}=(0,s.z8)(),[p,x]=(0,o.useState)(!1),[b,g]=(0,o.useState)(h),j=(0,o.useCallback)(function(){x(!0)},[x]),y=(0,o.useCallback)(function(){x(!1),g(h)},[x,g]),N=(0,o.useCallback)(function(e){g(function(t){return{...t,[e.target.name]:e.target.value}})},[g]),v=(0,o.useCallback)(function(e){e.preventDefault(),d(function(e){let t={...e,[f]:{...e[f],[s.Ki.posts]:[...e[f][s.Ki.posts],b]}};return localStorage.setItem(s.BY,JSON.stringify(t)),t}),y()},[y,d,f,b]);return p?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:v,children:[(0,a.jsx)("input",{autoFocus:!0,type:"text",placeholder:l,name:"slug",onChange:N}),(0,a.jsx)("input",{type:"text",placeholder:c,name:"title",onChange:N}),(0,a.jsx)(m,{name:"datetime",onChange:N}),(0,a.jsx)("input",{type:"text",placeholder:i,name:"excerpt",onChange:N}),(0,a.jsx)("textarea",{placeholder:u,name:"content",onChange:N}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:n}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:y,children:t})]})]}):(0,a.jsx)("button",{type:"button",className:"button",onClick:j,children:e})}function g(e){let{index:t}=e,{uploadImage:n,updateArrayData:l}=(0,s.z8)(),[r,c]=(0,o.useState)(null),[i,u]=(0,o.useState)(null),[d,f]=(0,o.useState)("");async function p(){if(i){f("Loading...");try{let e=await n(i);l(s.Ki.posts,t)({target:{name:"image",value:e}}),f("Uploaded: /".concat(e))}catch(e){console.error(e),f("Upload failed")}}}return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];if(n){u(n);let e=new FileReader;e.onloadend=()=>c(e.result),e.readAsDataURL(n)}}}),r&&(0,a.jsx)("img",{src:r,alt:"preview",className:"w-full max-w-sm rounded border"}),(0,a.jsx)("button",{onClick:p,disabled:!i,className:"bg-emerald-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Загрузить"}),d&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:d})]})}var j=n(9300),y=n.n(j);function N(e){let{open:t,onClose:n,children:s,maxWidth:l="max-w-4xl"}=e,c=(0,o.useRef)(null);return(0,o.useEffect)(function(){let e=c.current;e&&(t&&!e.open?e.showModal():!t&&e.open&&e.close())},[t]),(0,o.useEffect)(function(){let e=c.current;if(e)return e.addEventListener("close",t),function(){e.removeEventListener("close",t)};function t(){return n()}},[n]),(0,a.jsxs)("dialog",{ref:c,className:y()("dark:backdrop:bg-black/50 backdrop:bg-white/50 rounded-lg p-6 w-full absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 shadow","bg-gray-100 dark:bg-gray-700",l),children:[(0,a.jsx)("button",{className:"absolute right-0 top-0 cursor-pointer",onClick:n,children:(0,r.s)("button.close")}),(0,a.jsx)("div",{children:s})]})}function v(e){let{index:t,filename:n,onClose:l}=e,{getImagesList:r,setLoadedData:c,lang:i}=(0,s.z8)(),[u,d]=(0,o.useState)([]);return(0,o.useEffect)(function(){!async function(){d((await r()).map(function(e){let{name:t,path:n}=e;return{name:t,path:n.replace("public/","/")}}))}()},[r,d]),(0,a.jsx)("div",{className:"flex gap-3",children:u.map(function(e,o){let{name:r,path:u}=e;return(0,a.jsx)("img",{src:u,alt:"",className:"w-40 h-40 object-cover rounded cursor-pointer",onClick:function(){c(function(e){let a=structuredClone(e);return a[i][n][t].image=u,localStorage.setItem(s.BY,JSON.stringify(a)),a}),l()}},o)})})}function C(e){let{image:t,index:n}=e,l=(0,r.s)("button.delete"),c=(0,r.s)("button.replace"),i=(0,r.s)("label.or"),u=(0,r.s)("button.choose"),{setLoadedData:d,lang:f}=(0,s.z8)(),[p,x]=(0,o.useState)(-1),m=(0,o.useCallback)(function(){x(n)},[x,n]),h=(0,o.useCallback)(function(){x(-1)},[x]),b=(0,o.useCallback)(function(e){return function(){d(function(t){let n=structuredClone(t);return n[f][s.Ki.posts][e].image="",localStorage.setItem(s.BY,JSON.stringify(n)),n})}},[f,d]);return(0,a.jsxs)(a.Fragment,{children:[""!==t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:t,alt:"",className:"rounded max-w-[200px]"}),(0,a.jsxs)("div",{className:"flex gap-3 p-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:b(n),children:l}),(0,a.jsx)("button",{type:"button",className:"button",onClick:m,children:c})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{index:n}),(0,a.jsx)("div",{children:i}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",className:"button",onClick:m,children:u})})]}),p>-1&&(0,a.jsx)(N,{open:!0,onClose:h,children:(0,a.jsx)(v,{index:p,filename:s.Ki.posts,onClose:h})})]})}function k(e){let{index:t}=e,n=(0,r.s)("areYouSure"),l=(0,r.s)("button.cancel"),c=(0,r.s)("button.delete"),{removeFromArrayData:i}=(0,s.z8)(),[u,d]=(0,o.useState)(-1),f=(0,o.useCallback)(function(){d(-1)},[d]),p=(0,o.useCallback)(function(){i(s.Ki.posts,t),d(-1)},[t,i,d]),x=(0,o.useCallback)(function(){d(t)},[t,d]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:x,children:"X"}),u>-1&&(0,a.jsxs)(N,{maxWidth:"max-w-xl",open:!0,onClose:f,children:[(0,a.jsx)("h5",{className:"text-gray-800 dark:text-gray-100 text-center p-5",children:n}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:f,children:l}),(0,a.jsx)("button",{type:"button",className:"button",onClick:p,children:c})]})]})]})}function S(){let e=(0,r.s)("label.url"),t=(0,r.s)("label.title"),n=(0,r.s)("label.excerpt"),l=(0,r.s)("label.content"),{loadedData:c,updateArrayData:i,loadData:u}=(0,s.z8)();return(0,o.useEffect)(function(){u(s.Ki.posts)},[]),c[s.Ki.posts].map(function(o,r){let{slug:c,title:u,image:d,excerpt:f,content:p,datetime:x}=o,h=i(s.Ki.posts,r);return(0,a.jsxs)("div",{className:"grid grid-cols-[2fr_1fr] gap-3 border-b border-gray-200 dark:border-gray-800 py-6 mb-3",children:[(0,a.jsx)("input",{type:"text",placeholder:e,defaultValue:c,name:"slug",onChange:h}),(0,a.jsxs)("div",{className:"rounded row-span-4 flex",children:[(0,a.jsx)("div",{className:"flex-1 pr-5",children:(0,a.jsx)(C,{image:d,index:r})}),(0,a.jsx)("div",{children:(0,a.jsx)(k,{index:r})})]}),(0,a.jsx)("input",{type:"text",placeholder:t,defaultValue:u,name:"title",onChange:h}),(0,a.jsx)(m,{name:"datetime",onChange:h,defaultValue:x}),(0,a.jsx)("input",{type:"text",placeholder:n,defaultValue:f,name:"excerpt",onChange:h}),(0,a.jsx)("textarea",{placeholder:l,defaultValue:p,name:"content",onChange:h})]},r)})}function w(){return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(S,{}),(0,a.jsx)(b,{}),(0,a.jsx)(c,{filename:s.Ki.posts})]})}function K(){let e=(0,x.useSearchParams)(),t=(0,x.useRouter)(),n=e.get("tab"),s=n?parseInt(n,10):0,[c,d]=(0,o.useState)(s);return(0,o.useEffect)(function(){history.replaceState(null,"","?tab=".concat(c))},[c,t]),(0,a.jsxs)("div",{className:"max-w-5xl bg-gray-100 dark:bg-gray-700 rounded px-1 py-3 lg:px-3 mx-2 lg:mx-auto shadow",children:[(0,a.jsx)(u,{}),(0,a.jsxs)(l.fu,{selectedIndex:c,onChange:d,className:"px-2",children:[(0,a.jsxs)(l.wb,{className:"flex gap-4 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded overflow-auto scrollbar-hide",children:[(0,a.jsx)(l.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,r.s)("tab.translations")}),(0,a.jsx)(l.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,r.s)("tab.features")}),(0,a.jsx)(l.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,r.s)("tab.posts")}),(0,a.jsx)(l.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,r.s)("tab.contacts")})]}),(0,a.jsxs)(l.T2,{className:"mt-3 py-3",children:[(0,a.jsx)(l.Kp,{children:(0,a.jsx)(i,{})}),(0,a.jsx)(l.Kp,{children:(0,a.jsx)(p,{})}),(0,a.jsx)(l.Kp,{children:(0,a.jsx)(w,{})}),(0,a.jsx)(l.Kp,{children:"contacts tab content"})]})]})]})}function z(e){let{lang:t}=e;return(0,a.jsx)(s.X7,{lang:t,children:(0,a.jsx)(o.Suspense,{fallback:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(K,{})})})}},6099:(e,t,n)=>{"use strict";n.d(t,{I18nProvider:()=>o,s:()=>r});var a=n(5155),s=n(2115);let l=(0,s.createContext)({keys:{},features:[],posts:[]});function o(e){let{children:t,translations:n}=e;return(0,a.jsx)(l.Provider,{value:n,children:t})}function r(e){var t,n;let a=(0,s.useContext)(l);return"features"===e||"posts"===e?null!=(t=a[e])?t:"~".concat(e,"~"):null!=(n=a.keys[e])?n:"~".concat(e,"~")}},6593:(e,t,n)=>{"use strict";n.d(t,{X7:()=>C,BY:()=>y,Ki:()=>p,z8:()=>j});var a=n(5155),s=n(2115);let l="area-next",o="main";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/data/").concat(e,".json").concat(t)}var c=n(4134),i=n(6099);function u(){let[e,t]=(0,s.useState)(""),[n,l]=(0,s.useState)(!1),{loadFile:o}=j(),r=(0,i.s)("button.login"),c=(0,i.s)("password"),u=(0,i.s)("loading");return(0,a.jsx)("div",{className:"max-w-lg mx-auto py-36 px-4 md:px-0",children:(0,a.jsxs)("form",{className:"flex max-md:flex-col gap-4",onSubmit:async function(t){t.preventDefault(),l(!0),await o(p.common,e)},children:[(0,a.jsx)("input",{type:"password",placeholder:c,value:e,autoFocus:!0,className:"max-md:text-center",onChange:function(e){t(e.target.value)}}),(0,a.jsx)("button",{disabled:n,type:"submit",className:"button",children:n?u:r})]})})}var d=n(4052),f=n.n(d),p=function(e){return e.common="common",e.translations="translations",e.features="features",e.posts="posts",e}({});let x={common:"",translations:"",features:"",posts:""},m={en:x,lv:x,ru:x},h={common:{},translations:{},features:[],posts:[]},b={en:h,lv:h,ru:h},g=(0,s.createContext)({async loadFile(){},async publishData(){},logOut(){},loadedData:h,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async getImagesList(){},removeFromArrayData(){}});function j(){return(0,s.useContext)(g)}let y="loaded-data",N="sha-data",v="token";function C(e){let{children:t,lang:n}=e,d=(0,i.s)("loading"),[p,x]=(0,s.useState)(""),[h,j]=(0,s.useState)(!1),[C,k]=(0,s.useState)(m),[S,w]=(0,s.useState)(b),[K,z]=(0,s.useState)(!1);(0,s.useEffect)(function(){try{let e=localStorage.getItem(y);e&&w(JSON.parse(e||"{}"));let t=localStorage.getItem(N);t&&k(JSON.parse(t||"{}"))}catch(e){console.log(e)}},[w,k]),(0,s.useEffect)(function(){try{let e=localStorage.getItem(v);null!==e&&x(JSON.parse(e))}catch(e){console.log(e)}},[x]);let O=(0,s.useCallback)(function(e,t){k(function(a){let s={...a,[n]:{...a[n],[e]:t}};return localStorage.setItem(N,JSON.stringify(s)),s})},[n]),I=(0,s.useCallback)(async function(e,t){try{let a=await fetch(r("".concat(n,"/").concat(e),"?ref=".concat(o)),{headers:{Authorization:"token ".concat(t||p)}}),s=await a.json();if(s.status)return;return t&&(localStorage.setItem(v,JSON.stringify(t)),x(t)),{content:c.hp.from(s.content,"base64").toString("utf8"),sha:s.sha}}catch(e){console.error(e)}},[n,j,p]),E=(0,s.useCallback)(async function(e,t,a){try{let s=c.hp.from(t).toString("base64"),l=await fetch(r("".concat(n,"/").concat(e)),{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(e,".json)"),content:s,sha:a,branch:o})}),i=await l.json();if(l.ok)return{sha:i.content.sha};console.error(i)}catch(e){console.error(e)}},[p,n]),F=(0,s.useCallback)(async function(e){if(Object.keys(S[n][e]).length>0)return;let t=await I(e);if(t)try{w(function(a){let s={...a,[n]:{...a[n],[e]:JSON.parse(t.content)}};return localStorage.setItem(y,JSON.stringify(s)),s}),O(e,t.sha)}catch(e){console.log(e)}},[I,S,w,n]),J=(0,s.useCallback)(async function(e){try{z(!0);let t=await E(e,JSON.stringify(S[n][e],null,2),C[n][e]);t&&O(e,t.sha),z(!1)}catch(e){console.log(e)}},[E,C,S,n,z]),D=(0,s.useCallback)(function(){localStorage.removeItem(v),localStorage.removeItem(y),localStorage.removeItem(N),window.location.reload()},[]),V=f()(function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}},400),L=(0,s.useCallback)(function(e){return function(t){w(function(a){let s={...a,[n]:{...a[n],translations:{...a[n].translations,[e]:t.target.value}}};return V(y,s),s})}},[n,V,w]),P=(0,s.useCallback)(function(e,t){return function(a){w(function(s){let l=structuredClone(s[n][e]);l[t][a.target.name]=a.target.value;let o={...s,[n]:{...s[n],[e]:l}};return V(y,o),o})}},[n,V,w]),A=(0,s.useCallback)(async function(e){var t;let n=new FileReader,a=await new Promise((t,a)=>{n.onloadend=()=>{t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)}),s=(t=e.name,"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/public/data/images/").concat(t)),r=await fetch(s,{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(s.split("contents")[1]),content:a,branch:o})});if(!r.ok)throw Error("Failed to upload image");return(await r.json()).content.path.replace("public/","/")},[p]),R=(0,s.useCallback)(async function(){return await (await fetch("https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(p),Accept:"application/vnd.github.v3+json"}})).json()},[p]),_=(0,s.useCallback)(function(e,t){w(function(a){let s=structuredClone(a);return s[n][e].splice(t,1),V(y,s),s})},[w,n]);return(0,a.jsx)(g.Provider,{value:{loadFile:I,publishData:E,logOut:D,loadedData:S[n],setLoadedData:w,loadData:F,saveData:J,updateRecordData:L,updateArrayData:P,lang:n,publishLoading:K,setPublishLoading:z,uploadImage:A,getImagesList:R,removeFromArrayData:_},children:h?(0,a.jsx)("div",{className:"max-w-lg mx-auto flex items-center justify-center min-h-48",children:d}):p?t:(0,a.jsx)(u,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[877,406,441,684,358],()=>t(799)),_N_E=e.O()}]);