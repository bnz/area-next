(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{799:(e,t,a)=>{Promise.resolve().then(a.bind(a,8273))},6099:(e,t,a)=>{"use strict";a.d(t,{I18nProvider:()=>o,s:()=>r});var n=a(5155),s=a(2115);let l=(0,s.createContext)({keys:{},features:[],posts:[]});function o(e){let{children:t,translations:a}=e;return(0,n.jsx)(l.Provider,{value:a,children:t})}function r(e){var t,a;let n=(0,s.useContext)(l);return"features"===e||"posts"===e?null!=(t=n[e])?t:"~".concat(e,"~"):null!=(a=n.keys[e])?a:"~".concat(e,"~")}},8273:(e,t,a)=>{"use strict";a.d(t,{Login:()=>z});var n=a(5155),s=a(2115);let l="area-next",o="main";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/data/").concat(e,".json").concat(t)}var c=a(4134),i=a(6099);function u(){let[e,t]=(0,s.useState)(""),[a,l]=(0,s.useState)(!1),{loadFile:o}=j(),r=(0,i.s)("button.login"),c=(0,i.s)("password"),u=(0,i.s)("loading");return(0,n.jsx)("div",{className:"max-w-lg mx-auto py-36",children:(0,n.jsxs)("form",{className:"flex gap-4",onSubmit:async function(t){t.preventDefault(),l(!0),await o(p.common,e)},children:[(0,n.jsx)("input",{type:"password",placeholder:c,value:e,autoFocus:!0,onChange:function(e){t(e.target.value)}}),(0,n.jsx)("button",{disabled:a,type:"submit",className:"button",children:a?u:r})]})})}var d=a(4052),f=a.n(d),p=function(e){return e.common="common",e.translations="translations",e.features="features",e.posts="posts",e}({});let m={common:"",translations:"",features:"",posts:""},x={en:m,lv:m,ru:m},h={common:{},translations:{},features:[],posts:[]},g={en:h,lv:h,ru:h},b=(0,s.createContext)({async loadFile(){},async publishData(){},logOut(){},loadedData:h,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){}});function j(){return(0,s.useContext)(b)}let y="loaded-data",N="sha-data",v="token";function S(e){let{children:t,lang:a}=e,d=(0,i.s)("loading"),[p,m]=(0,s.useState)(""),[h,j]=(0,s.useState)(!1),[S,k]=(0,s.useState)(x),[w,C]=(0,s.useState)(g),[O,I]=(0,s.useState)(!1);(0,s.useEffect)(function(){try{let e=localStorage.getItem(y);e&&C(JSON.parse(e||"{}"));let t=localStorage.getItem(N);t&&k(JSON.parse(t||"{}"))}catch(e){console.log(e)}},[C,k]),(0,s.useEffect)(function(){try{let e=localStorage.getItem(v);null!==e&&m(JSON.parse(e))}catch(e){console.log(e)}},[m]);let D=(0,s.useCallback)(function(e,t){k(function(n){let s={...n,[a]:{...n[a],[e]:t}};return localStorage.setItem(N,JSON.stringify(s)),s})},[a]),J=(0,s.useCallback)(async function(e,t){try{let n=await fetch(r("".concat(a,"/").concat(e),"?ref=".concat(o)),{headers:{Authorization:"token ".concat(t||p)}}),s=await n.json();if(s.status)return;return t&&(localStorage.setItem(v,JSON.stringify(t)),m(t)),{content:c.hp.from(s.content,"base64").toString("utf8"),sha:s.sha}}catch(e){console.error(e)}},[a,j,p]),E=(0,s.useCallback)(async function(e,t,n){try{let s=c.hp.from(t).toString("base64"),l=await fetch(r("".concat(a,"/").concat(e)),{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(a,"/").concat(e,".json)"),content:s,sha:n,branch:o})}),i=await l.json();if(l.ok)return{sha:i.content.sha};console.error(i)}catch(e){console.error(e)}},[p,a]),F=(0,s.useCallback)(async function(e){if(Object.keys(w[a][e]).length>0)return;let t=await J(e);if(t)try{C(function(n){let s={...n,[a]:{...n[a],[e]:JSON.parse(t.content)}};return localStorage.setItem(y,JSON.stringify(s)),s}),D(e,t.sha)}catch(e){console.log(e)}},[J,w,C,a]),z=(0,s.useCallback)(async function(e){try{I(!0);let t=await E(e,JSON.stringify(w[a][e],null,2),S[a][e]);t&&D(e,t.sha),I(!1)}catch(e){console.log(e)}},[E,S,w,a,I]),P=(0,s.useCallback)(function(){localStorage.removeItem(v),localStorage.removeItem(y),localStorage.removeItem(N),window.location.reload()},[]),V=f()(function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}},400),T=(0,s.useCallback)(function(e){return function(t){C(function(n){let s={...n,[a]:{...n[a],translations:{...n[a].translations,[e]:t.target.value}}};return V(y,s),s})}},[a,V,C]),_=(0,s.useCallback)(function(e,t){return function(n){C(function(s){let l=structuredClone(s[a][e]);l[t][n.target.name]=n.target.value;let o={...s,[a]:{...s[a],[e]:l}};return V(y,o),o})}},[a,V,C]),L=(0,s.useCallback)(async(e,t)=>{var a;let n=new FileReader,s=await new Promise((t,a)=>{n.onloadend=()=>{t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)}),r=(a=e.name,"https://api.github.com/repos/".concat("bnz","/").concat(l,"/contents/public/data/images/").concat(a)),c=await fetch(r,{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(r.split("contents")[1]),content:s,branch:o})});if(!c.ok)throw Error("Failed to upload image");return(await c.json()).content.path.replace("public/","/")},[p]);return(0,n.jsx)(b.Provider,{value:{loadFile:J,publishData:E,logOut:P,loadedData:w[a],setLoadedData:C,loadData:F,saveData:z,updateRecordData:T,updateArrayData:_,lang:a,publishLoading:O,setPublishLoading:I,uploadImage:L},children:h?(0,n.jsx)("div",{className:"max-w-lg mx-auto flex items-center justify-center min-h-48",children:d}):p?t:(0,n.jsx)(u,{})})}var k=a(5739);function w(e){let{filename:t}=e,{saveData:a,publishLoading:s}=j(),l=(0,i.s)("loading");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("button",{className:"button",type:"button",onClick:async function(){await a(t)},children:(0,i.s)("button.publish")})}),s&&(0,n.jsx)("div",{className:"absolute -inset-1 bg-gray-100/90 rounded flex items-center justify-center",children:l})]})}function C(){let{loadedData:e,loadData:t,saveData:a,updateRecordData:l,publishLoading:o}=j(),r=(0,i.s)("loading");(0,s.useEffect)(function(){t(p.translations)},[]);let c=e[p.translations];return 0===Object.keys(c).length?(0,n.jsx)(n.Fragment,{children:r}):(0,n.jsxs)("div",{className:"flex flex-col gap-3 relative",children:[Object.keys(c).map(function(e){return(0,n.jsxs)("label",{children:[(0,n.jsx)("div",{className:"text-xs font-sans",children:e}),(0,n.jsx)("textarea",{rows:1,defaultValue:c[e],onChange:l(e)})]},e)}),(0,n.jsx)(w,{filename:p.translations})]})}function O(){let{logOut:e}=j(),t=(0,i.s)("button.logout"),a=(0,i.s)("welcome");return(0,n.jsxs)("div",{className:"flex flex-row gap-3 mb-3 px-2",children:[(0,n.jsx)("h3",{className:"text-xl font-bold",children:a}),(0,n.jsx)("button",{type:"button",className:"button ml-auto",onClick:e,children:t})]})}function I(){let e=(0,i.s)("button.add"),[t,a]=(0,s.useState)(!1),{loadData:l,loadedData:o,setLoadedData:r,lang:c,updateArrayData:u}=j(),[d,f]=(0,s.useState)({title:"",description:""});(0,s.useEffect)(function(){l(p.features)},[]);let m=o[p.features];return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"mb-5",children:m.map(function(e,t){let{title:a,description:s}=e;return(0,n.jsxs)("div",{className:"grid grid-cols-[1fr_35px] gap-3 outline-1 outline-gray-300 dark:outline-gray-700 mb-5 p-2 rounded",children:[(0,n.jsx)("input",{type:"text",defaultValue:a,placeholder:"Title",name:"title",onChange:u(p.features,t)}),(0,n.jsx)("div",{className:"row-span-2 flex items-center justify-center",children:(0,n.jsx)("button",{className:"button",type:"button",onClick:function(){r(function(e){let a=structuredClone(e);return a[c][p.features].splice(t,1),localStorage.setItem(y,JSON.stringify(a)),a})},children:"X"})}),(0,n.jsx)("textarea",{rows:1,placeholder:"Description",defaultValue:s,name:"description",onChange:u(p.features,t)})]},t)})}),(0,n.jsx)("div",{className:"py-3 border-t border-gray-300 dark:border-gray-700",children:t?(0,n.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:function(e){e.preventDefault(),r(function(e){let t={...e,[c]:{...e[c],[p.features]:[...e[c][p.features],d]}};return localStorage.setItem(y,JSON.stringify(t)),t}),a(!1)},children:[(0,n.jsx)("input",{type:"text",placeholder:"Title",autoFocus:!0,defaultValue:d.title,onChange:function(e){f(function(t){return{...t,title:e.target.value}})}}),(0,n.jsx)("textarea",{rows:1,placeholder:"Description",defaultValue:d.description,onChange:function(e){f(function(t){return{...t,description:e.target.value}})}}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("button",{className:"button",type:"submit",children:"Save"}),(0,n.jsx)("button",{type:"button",className:"cursor-pointer",onClick:function(){a(function(e){return!e})},children:"Cancel"})]})]}):(0,n.jsx)("button",{className:"button",type:"button",onClick:function(){a(!0)},children:e})}),(0,n.jsx)(w,{filename:p.features})]})}var D=a(5695);function J(e){let{lang:t,index:a}=e,{uploadImage:l,updateArrayData:o}=j(),[r,c]=(0,s.useState)(null),[i,u]=(0,s.useState)(null),[d,f]=(0,s.useState)("");async function m(){if(i){f("Loading...");try{let e=await l(i,t);o(p.posts,a)({target:{name:"image",value:e}}),f("Uploaded: /".concat(e))}catch(e){console.error(e),f("Upload failed")}}}return(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){u(a);let e=new FileReader;e.onloadend=()=>c(e.result),e.readAsDataURL(a)}}}),r&&(0,n.jsx)("img",{src:r,alt:"preview",className:"w-full max-w-sm rounded border"}),(0,n.jsx)("button",{onClick:m,disabled:!i,className:"bg-emerald-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Загрузить"}),d&&(0,n.jsx)("p",{className:"text-sm text-gray-500",children:d})]})}function E(){let{loadData:e,loadedData:t,lang:a,setLoadedData:l}=j();(0,s.useEffect)(function(){e(p.posts)},[]);let o=t[p.posts],r=(0,s.useCallback)(function(e){return function(){l(function(e){return structuredClone(e),e})}},[l]),c=(0,s.useCallback)(function(){},[]);return(0,n.jsxs)("div",{className:"relative",children:[o.map(function(e,t){let{slug:s,title:l,image:o,excerpt:i,content:u}=e;return(0,n.jsxs)("div",{className:"grid grid-cols-[2fr_1fr] gap-3 border-b border-gray-200 dark:border-gray-800 py-6",children:[(0,n.jsx)("input",{type:"text",placeholder:"Url",defaultValue:s,name:"slug"}),(0,n.jsx)("div",{className:"rounded row-span-4",children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:o,alt:"",className:"rounded max-w-[200px]"}),(0,n.jsxs)("div",{className:"flex gap-3 p-3",children:[(0,n.jsx)("button",{type:"button",className:"button",onClick:r(t),children:"delete"}),(0,n.jsx)("button",{type:"button",className:"button",onClick:c,children:"replace"})]})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(J,{lang:a,index:t})})}),(0,n.jsx)("input",{type:"text",placeholder:"Title",defaultValue:l,name:"title"}),(0,n.jsx)("input",{type:"text",placeholder:"Excerpt",defaultValue:i,name:"excerpt"}),(0,n.jsx)("textarea",{placeholder:"Content",defaultValue:u,name:"content"})]},t)}),(0,n.jsx)(w,{filename:p.posts})]})}function F(){let e=(0,D.useSearchParams)(),t=(0,D.useRouter)(),a=e.get("tab"),l=a?parseInt(a,10):0,[o,r]=(0,s.useState)(l);return(0,s.useEffect)(function(){history.replaceState(null,"","?tab=".concat(o))},[o,t]),(0,n.jsxs)("div",{className:"max-w-5xl bg-gray-100 dark:bg-gray-700 rounded px-1 py-3 lg:px-3 mx-2 lg:mx-auto shadow",children:[(0,n.jsx)(O,{}),(0,n.jsxs)(k.fu,{selectedIndex:o,onChange:r,className:"px-2",children:[(0,n.jsxs)(k.wb,{className:"flex gap-4 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded overflow-auto scrollbar-hide",children:[(0,n.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.translations")}),(0,n.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.features")}),(0,n.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.posts")}),(0,n.jsx)(k.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.contacts")})]}),(0,n.jsxs)(k.T2,{className:"mt-3 py-3",children:[(0,n.jsx)(k.Kp,{children:(0,n.jsx)(C,{})}),(0,n.jsx)(k.Kp,{children:(0,n.jsx)(I,{})}),(0,n.jsx)(k.Kp,{className:"",children:(0,n.jsx)(E,{})}),(0,n.jsx)(k.Kp,{className:"",children:"contacts tab content"})]})]})]})}function z(e){let{lang:t}=e;return(0,n.jsx)(S,{lang:t,children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(n.Fragment,{}),children:(0,n.jsx)(F,{})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[965,441,684,358],()=>t(799)),_N_E=e.O()}]);