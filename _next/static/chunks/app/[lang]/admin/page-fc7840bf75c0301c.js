(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{799:(e,t,n)=>{Promise.resolve().then(n.bind(n,2919))},2919:(e,t,n)=>{"use strict";n.d(t,{Login:()=>R});var a=n(5155),s=n(2115);let o="area-next",l="main";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(o,"/contents/data/").concat(e,".json").concat(t)}var c=n(4134),i=n(6099);function u(){let[e,t]=(0,s.useState)(""),[n,o]=(0,s.useState)(!1),{loadFile:l}=j(),r=(0,i.s)("button.login"),c=(0,i.s)("password"),u=(0,i.s)("loading");return(0,a.jsx)("div",{className:"max-w-lg mx-auto py-36",children:(0,a.jsxs)("form",{className:"flex gap-4",onSubmit:async function(t){t.preventDefault(),o(!0),await l(p.common,e)},children:[(0,a.jsx)("input",{type:"password",placeholder:c,value:e,autoFocus:!0,onChange:function(e){t(e.target.value)}}),(0,a.jsx)("button",{disabled:n,type:"submit",className:"button",children:n?u:r})]})})}var d=n(4052),f=n.n(d),p=function(e){return e.common="common",e.translations="translations",e.features="features",e.posts="posts",e}({});let x={common:"",translations:"",features:"",posts:""},m={en:x,lv:x,ru:x},h={common:{},translations:{},features:[],posts:[]},g={en:h,lv:h,ru:h},b=(0,s.createContext)({async loadFile(){},async publishData(){},logOut(){},loadedData:h,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async getImagesList(){}});function j(){return(0,s.useContext)(b)}let y="loaded-data",N="sha-data",v="token";function C(e){let{children:t,lang:n}=e,d=(0,i.s)("loading"),[p,x]=(0,s.useState)(""),[h,j]=(0,s.useState)(!1),[C,S]=(0,s.useState)(m),[k,w]=(0,s.useState)(g),[O,I]=(0,s.useState)(!1);(0,s.useEffect)(function(){try{let e=localStorage.getItem(y);e&&w(JSON.parse(e||"{}"));let t=localStorage.getItem(N);t&&S(JSON.parse(t||"{}"))}catch(e){console.log(e)}},[w,S]),(0,s.useEffect)(function(){try{let e=localStorage.getItem(v);null!==e&&x(JSON.parse(e))}catch(e){console.log(e)}},[x]);let E=(0,s.useCallback)(function(e,t){S(function(a){let s={...a,[n]:{...a[n],[e]:t}};return localStorage.setItem(N,JSON.stringify(s)),s})},[n]),D=(0,s.useCallback)(async function(e,t){try{let a=await fetch(r("".concat(n,"/").concat(e),"?ref=".concat(l)),{headers:{Authorization:"token ".concat(t||p)}}),s=await a.json();if(s.status)return;return t&&(localStorage.setItem(v,JSON.stringify(t)),x(t)),{content:c.hp.from(s.content,"base64").toString("utf8"),sha:s.sha}}catch(e){console.error(e)}},[n,j,p]),J=(0,s.useCallback)(async function(e,t,a){try{let s=c.hp.from(t).toString("base64"),o=await fetch(r("".concat(n,"/").concat(e)),{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(e,".json)"),content:s,sha:a,branch:l})}),i=await o.json();if(o.ok)return{sha:i.content.sha};console.error(i)}catch(e){console.error(e)}},[p,n]),F=(0,s.useCallback)(async function(e){if(Object.keys(k[n][e]).length>0)return;let t=await D(e);if(t)try{w(function(a){let s={...a,[n]:{...a[n],[e]:JSON.parse(t.content)}};return localStorage.setItem(y,JSON.stringify(s)),s}),E(e,t.sha)}catch(e){console.log(e)}},[D,k,w,n]),z=(0,s.useCallback)(async function(e){try{I(!0);let t=await J(e,JSON.stringify(k[n][e],null,2),C[n][e]);t&&E(e,t.sha),I(!1)}catch(e){console.log(e)}},[J,C,k,n,I]),L=(0,s.useCallback)(function(){localStorage.removeItem(v),localStorage.removeItem(y),localStorage.removeItem(N),window.location.reload()},[]),V=f()(function(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}},400),P=(0,s.useCallback)(function(e){return function(t){w(function(a){let s={...a,[n]:{...a[n],translations:{...a[n].translations,[e]:t.target.value}}};return V(y,s),s})}},[n,V,w]),T=(0,s.useCallback)(function(e,t){return function(a){w(function(s){let o=structuredClone(s[n][e]);o[t][a.target.name]=a.target.value;let l={...s,[n]:{...s[n],[e]:o}};return V(y,l),l})}},[n,V,w]),A=(0,s.useCallback)(async function(e){var t;let n=new FileReader,a=await new Promise((t,a)=>{n.onloadend=()=>{t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)}),s=(t=e.name,"https://api.github.com/repos/".concat("bnz","/").concat(o,"/contents/public/data/images/").concat(t)),r=await fetch(s,{method:"PUT",headers:{Authorization:"token ".concat(p),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(s.split("contents")[1]),content:a,branch:l})});if(!r.ok)throw Error("Failed to upload image");return(await r.json()).content.path.replace("public/","/")},[p]),R=(0,s.useCallback)(async function(){let e=await fetch("https://api.github.com/repos/".concat("bnz","/").concat(o,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(p),Accept:"application/vnd.github.v3+json"}});return await e.json()},[p]);return(0,a.jsx)(b.Provider,{value:{loadFile:D,publishData:J,logOut:L,loadedData:k[n],setLoadedData:w,loadData:F,saveData:z,updateRecordData:P,updateArrayData:T,lang:n,publishLoading:O,setPublishLoading:I,uploadImage:A,getImagesList:R},children:h?(0,a.jsx)("div",{className:"max-w-lg mx-auto flex items-center justify-center min-h-48",children:d}):p?t:(0,a.jsx)(u,{})})}var S=n(5739);function k(e){let{filename:t}=e,{saveData:n,publishLoading:s}=j(),o=(0,i.s)("loading");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:async function(){await n(t)},children:(0,i.s)("button.publish")})}),s&&(0,a.jsx)("div",{className:"absolute -inset-1 bg-gray-100/90 dark:bg-gray-700/90 rounded flex items-center justify-center",children:o})]})}function w(){let{loadedData:e,loadData:t,saveData:n,updateRecordData:o,publishLoading:l}=j(),r=(0,i.s)("loading");(0,s.useEffect)(function(){t(p.translations)},[]);let c=e[p.translations];return 0===Object.keys(c).length?(0,a.jsx)(a.Fragment,{children:r}):(0,a.jsxs)("div",{className:"flex flex-col gap-3 relative",children:[Object.keys(c).map(function(e){return(0,a.jsxs)("label",{children:[(0,a.jsx)("div",{className:"text-xs font-sans",children:e}),(0,a.jsx)("textarea",{rows:1,defaultValue:c[e],onChange:o(e)})]},e)}),(0,a.jsx)(k,{filename:p.translations})]})}function O(){let{logOut:e}=j(),t=(0,i.s)("button.logout"),n=(0,i.s)("welcome");return(0,a.jsxs)("div",{className:"flex flex-row gap-3 mb-3 px-2",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"button ml-auto",onClick:e,children:t})]})}function I(){let e=(0,i.s)("button.add"),[t,n]=(0,s.useState)(!1),{loadData:o,loadedData:l,setLoadedData:r,lang:c,updateArrayData:u}=j(),[d,f]=(0,s.useState)({title:"",description:""});(0,s.useEffect)(function(){o(p.features)},[]);let x=l[p.features];return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"mb-5",children:x.map(function(e,t){let{title:n,description:s}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_35px] gap-3 outline-1 outline-gray-300 dark:outline-gray-700 mb-5 p-2 rounded",children:[(0,a.jsx)("input",{type:"text",defaultValue:n,placeholder:"Title",name:"title",onChange:u(p.features,t)}),(0,a.jsx)("div",{className:"row-span-2 flex items-center justify-center",children:(0,a.jsx)("button",{className:"button",type:"button",onClick:function(){r(function(e){let n=structuredClone(e);return n[c][p.features].splice(t,1),localStorage.setItem(y,JSON.stringify(n)),n})},children:"X"})}),(0,a.jsx)("textarea",{rows:1,placeholder:"Description",defaultValue:s,name:"description",onChange:u(p.features,t)})]},t)})}),(0,a.jsx)("div",{className:"py-3 border-t border-gray-300 dark:border-gray-700",children:t?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:function(e){e.preventDefault(),r(function(e){let t={...e,[c]:{...e[c],[p.features]:[...e[c][p.features],d]}};return localStorage.setItem(y,JSON.stringify(t)),t}),n(!1)},children:[(0,a.jsx)("input",{type:"text",placeholder:"Title",autoFocus:!0,defaultValue:d.title,onChange:function(e){f(function(t){return{...t,title:e.target.value}})}}),(0,a.jsx)("textarea",{rows:1,placeholder:"Description",defaultValue:d.description,onChange:function(e){f(function(t){return{...t,description:e.target.value}})}}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:"Save"}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:function(){n(function(e){return!e})},children:"Cancel"})]})]}):(0,a.jsx)("button",{className:"button",type:"button",onClick:function(){n(!0)},children:e})}),(0,a.jsx)(k,{filename:p.features})]})}var E=n(5695);function D(e){let{index:t}=e,{uploadImage:n,updateArrayData:o}=j(),[l,r]=(0,s.useState)(null),[c,i]=(0,s.useState)(null),[u,d]=(0,s.useState)("");async function f(){if(c){d("Loading...");try{let e=await n(c);o(p.posts,t)({target:{name:"image",value:e}}),d("Uploaded: /".concat(e))}catch(e){console.error(e),d("Upload failed")}}}return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];if(n){i(n);let e=new FileReader;e.onloadend=()=>r(e.result),e.readAsDataURL(n)}}}),l&&(0,a.jsx)("img",{src:l,alt:"preview",className:"w-full max-w-sm rounded border"}),(0,a.jsx)("button",{onClick:f,disabled:!c,className:"bg-emerald-600 text-white px-4 py-2 rounded disabled:opacity-50",children:"Загрузить"}),u&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:u})]})}var J=n(9300),F=n.n(J);function z(e){let{open:t,onClose:n,children:o,maxWidth:l="max-w-4xl"}=e,r=(0,s.useRef)(null);return(0,s.useEffect)(function(){let e=r.current;e&&(t&&!e.open?e.showModal():!t&&e.open&&e.close())},[t]),(0,s.useEffect)(function(){let e=r.current;if(e)return e.addEventListener("close",t),function(){e.removeEventListener("close",t)};function t(){return n()}},[n]),(0,a.jsxs)("dialog",{ref:r,className:F()("dark:backdrop:bg-black/50 backdrop:bg-white/50 rounded-lg p-6 w-full absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 shadow","bg-gray-100 dark:bg-gray-700",l),children:[(0,a.jsx)("button",{className:"absolute right-0 top-0 cursor-pointer",onClick:n,children:"close"}),(0,a.jsx)("div",{children:o})]})}function L(e){let{index:t,filename:n,onClose:o}=e,{getImagesList:l,setLoadedData:r,lang:c}=j(),[i,u]=(0,s.useState)([]);return(0,s.useEffect)(function(){!async function(){u((await l()).map(function(e){let{name:t,path:n}=e;return{name:t,path:n.replace("public/","/")}}))}()},[l,u]),(0,a.jsx)("div",{className:"flex gap-3",children:i.map(function(e,s){let{name:l,path:i}=e;return(0,a.jsx)("img",{src:i,alt:"",className:"w-40 h-40 object-cover rounded cursor-pointer",onClick:function(){r(function(e){let a=structuredClone(e);return a[c][n][t].image=i,localStorage.setItem(y,JSON.stringify(a)),a}),o()}},s)})})}function V(e){let{name:t,onChange:n,defaultValue:o}=e,l=(0,s.useRef)(null);return(0,a.jsx)("input",{type:"datetime-local",ref:l,onClick:function(){var e,t;null==(t=l.current)||null==(e=t.showPicker)||e.call(t)},className:"cursor-pointer",name:t,onChange:n,defaultValue:o})}let P={slug:"",title:"",image:"",excerpt:"",content:"",datetime:""};function T(){let{loadData:e,loadedData:t,setLoadedData:n,updateArrayData:o,lang:l}=j();(0,s.useEffect)(function(){e(p.posts)},[]);let r=t[p.posts],[c,u]=(0,s.useState)(-1),[d,f]=(0,s.useState)(-1),[x,m]=(0,s.useState)(!1),[h,g]=(0,s.useState)(P),b=(0,s.useCallback)(function(e){g(function(t){return{...t,[e.target.name]:e.target.value}})},[g]),N=(0,s.useCallback)(function(e){return function(){n(function(t){let n=structuredClone(t);return n[l][p.posts][e].image="",localStorage.setItem(y,JSON.stringify(n)),n})}},[l,n]);return(0,a.jsxs)("div",{className:"relative",children:[r.map(function(e,t){let{slug:s,title:r,image:i,excerpt:x,content:m,datetime:h}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-[2fr_1fr] gap-3 border-b border-gray-200 dark:border-gray-800 py-6 mb-3",children:[(0,a.jsx)("input",{type:"text",placeholder:"Url",defaultValue:s,name:"slug",onChange:o(p.posts,t)}),(0,a.jsxs)("div",{className:"rounded row-span-4 flex",children:[(0,a.jsx)("div",{className:"flex-1 pr-5",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:i,alt:"",className:"rounded max-w-[200px]"}),(0,a.jsxs)("div",{className:"flex gap-3 p-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:N(t),children:"delete"}),(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){u(t)},children:"replace"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D,{index:t}),(0,a.jsx)("div",{children:"~ или ~"}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){u(t)},children:"Выбрать"})})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){f(t)},children:"X"}),d>-1&&(0,a.jsxs)(z,{maxWidth:"max-w-xl",open:!0,onClose:function(){f(-1)},children:[(0,a.jsx)("h5",{className:"text-gray-800 dark:text-gray-100 text-center p-5",children:"Delete?"}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-3",children:[(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){f(-1)},children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){n(function(e){let n=structuredClone(e);return n[l][p.posts].splice(t,1),localStorage.setItem(y,JSON.stringify(n)),n}),f(-1)},children:"DELETE"})]})]})]})]}),c>-1&&(0,a.jsx)(z,{open:!0,onClose:function(){u(-1)},children:(0,a.jsx)(L,{index:c,filename:p.posts,onClose:function(){u(-1)}})}),(0,a.jsx)("input",{type:"text",placeholder:"Title",defaultValue:r,name:"title",onChange:o(p.posts,t)}),(0,a.jsx)(V,{name:"datetime",onChange:o(p.posts,t),defaultValue:h}),(0,a.jsx)("input",{type:"text",placeholder:"Excerpt",defaultValue:x,name:"excerpt",onChange:o(p.posts,t)}),(0,a.jsx)("textarea",{placeholder:"Content",defaultValue:m,name:"content",onChange:o(p.posts,t)})]},t)}),x?(0,a.jsxs)("form",{className:"flex flex-col gap-3 p-2.5 m-2.5 bg-gray-100 dark:bg-gray-700 rounded shadow-inner",onSubmit:function(e){e.preventDefault(),n(function(e){let t={...e,[l]:{...e[l],[p.posts]:[...e[l][p.posts],h]}};return localStorage.setItem(y,JSON.stringify(t)),t}),m(!1)},children:[(0,a.jsx)("input",{autoFocus:!0,type:"text",placeholder:"Url",name:"slug",onChange:b}),(0,a.jsx)("input",{type:"text",placeholder:"Title",name:"title",onChange:b}),(0,a.jsx)(V,{name:"datetime",onChange:b}),(0,a.jsx)("input",{type:"text",placeholder:"Excerpt",name:"excerpt",onChange:b}),(0,a.jsx)("textarea",{placeholder:"Content",name:"content",onChange:b}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"button",type:"submit",children:"Save"}),(0,a.jsx)("button",{type:"button",className:"cursor-pointer",onClick:function(){m(function(e){return!e}),g(P)},children:"Cancel"})]})]}):(0,a.jsx)("button",{type:"button",className:"button",onClick:function(){m(!0)},children:(0,i.s)("button.add")}),(0,a.jsx)(k,{filename:p.posts})]})}function A(){let e=(0,E.useSearchParams)(),t=(0,E.useRouter)(),n=e.get("tab"),o=n?parseInt(n,10):0,[l,r]=(0,s.useState)(o);return(0,s.useEffect)(function(){history.replaceState(null,"","?tab=".concat(l))},[l,t]),(0,a.jsxs)("div",{className:"max-w-5xl bg-gray-100 dark:bg-gray-700 rounded px-1 py-3 lg:px-3 mx-2 lg:mx-auto shadow",children:[(0,a.jsx)(O,{}),(0,a.jsxs)(S.fu,{selectedIndex:l,onChange:r,className:"px-2",children:[(0,a.jsxs)(S.wb,{className:"flex gap-4 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded overflow-auto scrollbar-hide",children:[(0,a.jsx)(S.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.translations")}),(0,a.jsx)(S.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.features")}),(0,a.jsx)(S.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.posts")}),(0,a.jsx)(S.oz,{className:"px-3 py-2 data-selected:outline-1 cursor-pointer rounded",children:(0,i.s)("tab.contacts")})]}),(0,a.jsxs)(S.T2,{className:"mt-3 py-3",children:[(0,a.jsx)(S.Kp,{children:(0,a.jsx)(w,{})}),(0,a.jsx)(S.Kp,{children:(0,a.jsx)(I,{})}),(0,a.jsx)(S.Kp,{className:"",children:(0,a.jsx)(T,{})}),(0,a.jsx)(S.Kp,{className:"",children:"contacts tab content"})]})]})]})}function R(e){let{lang:t}=e;return(0,a.jsx)(C,{lang:t,children:(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(A,{})})})}},6099:(e,t,n)=>{"use strict";n.d(t,{I18nProvider:()=>l,s:()=>r});var a=n(5155),s=n(2115);let o=(0,s.createContext)({keys:{},features:[],posts:[]});function l(e){let{children:t,translations:n}=e;return(0,a.jsx)(o.Provider,{value:n,children:t})}function r(e){var t,n;let a=(0,s.useContext)(o);return"features"===e||"posts"===e?null!=(t=a[e])?t:"~".concat(e,"~"):null!=(n=a.keys[e])?n:"~".concat(e,"~")}}},e=>{var t=t=>e(e.s=t);e.O(0,[114,441,684,358],()=>t(799)),_N_E=e.O()}]);