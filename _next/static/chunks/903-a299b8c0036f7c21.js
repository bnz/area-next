"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{1774:(t,e,a)=>{a.d(e,{HC:()=>f,Ki:()=>r,yA:()=>u});var n=a(9723),o=a(4437),r=function(t){return t.common="common",t.translations="translations",t.features="features",t.posts="posts",t.splits="splits",t}({});let s=Object.values(r),c=n.z.object({id:n.z.string(),title:n.z.string(),subTitle:n.z.string(),image:n.z.string()}),i=n.z.object({id:n.z.string(),title:n.z.string(),excerpt:n.z.string(),image:n.z.string(),slug:n.z.string(),content:n.z.string(),datetime:n.z.string()}),l=n.z.object({id:n.z.string(),title:n.z.string(),description:n.z.string()}),u=n.z.record(n.z.enum(o.U),n.z.record(n.z.enum(s),n.z.string())),d=n.z.record(n.z.string(),n.z.string()),f=n.z.record(n.z.enum(o.U),n.z.object({common:d,translations:d,features:n.z.array(l),posts:n.z.array(i),splits:n.z.array(c)}));n.z.object({path:n.z.string(),name:n.z.string()})},4437:(t,e,a)=>{a.d(e,{U:()=>n});let n=["en","lv","ru"]},4903:(t,e,a)=>{a.d(e,{X7:()=>A,BY:()=>D,z8:()=>w});var n=a(5155),o=a(2115);let r="area-next",s="main";function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"https://api.github.com/repos/".concat("bnz","/").concat(r,"/contents/data/").concat(t,".json").concat(e)}var i=a(4134),l=a(6099),u=a(6048),d=a(1774),f=a(9300),p=a.n(f);function m(){let[t,e]=(0,o.useState)(""),[a,r]=(0,o.useState)(!1),{loadFile:s}=w(d.Ki.common),c=(0,l.s)("button.login"),i=(0,l.s)("password"),f=(0,l.s)("loading");return(0,n.jsx)("div",{className:p()("min-h-[300px] flex items-center justify-center"),children:(0,n.jsxs)("form",{className:"flex max-md:flex-col gap-4 md:max-w-1/2 mx-auto",onSubmit:async function(e){e.preventDefault(),r(!0),await s(t)},children:[(0,n.jsx)("input",{type:"password",placeholder:i,value:t,autoFocus:!0,className:"max-md:text-center min-w-[300px]",onChange:function(t){e(t.target.value)}}),(0,n.jsx)(u.jl,{disabled:a,children:a?f:c})]})})}var g=a(4437),h=a(4052),b=a.n(h),y=a(9231),z=a.n(y);function v(){return(0,n.jsx)("div",{className:"flex items-center justify-center max-lg:min-h-[300px] lg:min-h-[500px]",children:(0,l.s)("loading")})}let j={[d.Ki.common]:"",[d.Ki.translations]:"",[d.Ki.features]:"",[d.Ki.posts]:"",[d.Ki.splits]:""},x={en:j,lv:j,ru:j},C={[d.Ki.common]:{},[d.Ki.translations]:{},[d.Ki.features]:[],[d.Ki.posts]:[],[d.Ki.splits]:[]},S={en:C,lv:C,ru:C},k=(0,o.createContext)({async loadFile(){},logOut(){},loadedData:C,setLoadedData(){},async loadData(){},async saveData(){},updateRecordData:()=>function(){},updateArrayData:()=>function(){},lang:"en",publishLoading:!1,setPublishLoading(){},async uploadImage(){},async loadImagesList(){},imagesList:[],removeFromArrayData(){},saveToLocalStorage(){},areEqual:()=>!1,updateImage(){}});function w(t){let e=(0,o.useContext)(k);return{...e,...t?{loadFile:a=>e.loadFile(t,a),loadData:()=>e.loadData(t),saveData:a=>e.saveData(t,a),loadedData:e.loadedData[t],updateArrayData:a=>e.updateArrayData(t,a),areEqual:a=>e.areEqual(t,a),...t===d.Ki.posts||t===d.Ki.splits?{updateImage:(a,n)=>e.updateImage(t,a,n)}:{},...t===d.Ki.posts||t===d.Ki.features?{removeFromArrayData:a=>e.removeFromArrayData(t,a)}:{}}:{}}}let K=b()(function(t){try{localStorage.setItem(D,JSON.stringify(t))}catch(t){console.log(t)}},400),D="loaded-data",N="sha-data",I="token";function A(t){let{children:e,lang:a}=t,[l,u]=(0,o.useState)(""),[f,p]=(0,o.useState)(!1),[h,b]=(0,o.useState)(x),[y,j]=(0,o.useState)(S),[C,w]=(0,o.useState)(S),[A,J]=(0,o.useState)(!1),[F,E]=(0,o.useState)([]);(0,o.useEffect)(function(){try{let t=localStorage.getItem(D);if(t){let e=JSON.parse(t||"{}");j(e)}let e=localStorage.getItem(N);e&&b(d.yA.parse(JSON.parse(e||"{}")))}catch(t){console.log(t)}},[j,b]),(0,o.useEffect)(function(){try{let t=localStorage.getItem(I);null!==t&&u(JSON.parse(t))}catch(t){console.log(t)}},[u]);let U=(0,o.useCallback)(function(t,e){b(function(n){let o=d.yA.parse({...n,[a]:{...n[a],[t]:e}});return localStorage.setItem(N,JSON.stringify(o)),o})},[a,b]),H=(0,o.useCallback)(async function(t,e){try{let n=await fetch(c("".concat(a,"/").concat(t),"?ref=".concat(s)),{headers:{Authorization:"token ".concat(e||l)}}),o=await n.json();if(o.status)return;return e&&(localStorage.setItem(I,JSON.stringify(e)),u(e)),{content:i.hp.from(o.content,"base64").toString("utf8"),sha:o.sha}}catch(t){console.error(t)}},[a,l]),L=(0,o.useCallback)(async function(t,e,a,n){try{let o=i.hp.from(e).toString("base64"),r=await fetch(c("".concat(n,"/").concat(t)),{method:"PUT",headers:{Authorization:"token ".concat(l),"Content-Type":"application/json"},body:JSON.stringify({message:"i18n update from admin (/".concat(n,"/").concat(t,".json)"),content:o,sha:a,branch:s})}),u=await r.json();if(r.ok)return{sha:u.content.sha};console.error(u)}catch(t){console.error(t)}},[l,a]),P=(0,o.useCallback)(async function(t){let e=Object.keys(y[a][t]).length>0,n=Object.keys(C[a][t]).length>0;if(!e||!n){p(!0);let o=await H(t);try{if(p(!1),!o)return;e||(j(function(e){let n=d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}});return K(n),n}),U(t,o.sha)),n||w(function(e){return d.HC.parse({...e,[a]:{...e[a],[t]:JSON.parse(o.content)}})})}catch(t){console.log(t)}}},[H,y,C,j,a,w,p]),T=(0,o.useCallback)(async function(t,e){try{for(let n of(J(!0),e?g.U:[a])){let e=await L(t,JSON.stringify(y[n][t],null,2),h[n][t],n);e&&U(t,e.sha)}J(!1)}catch(t){console.log(t)}},[L,h,y,a,J]),_=(0,o.useCallback)(function(){localStorage.removeItem(I),localStorage.removeItem(D),localStorage.removeItem(N),window.location.reload()},[]),q=(0,o.useCallback)(function(t){return function(e){j(function(n){let o=d.HC.parse({...n,[a]:{...n[a],[d.Ki.translations]:{...n[a][d.Ki.translations],[t]:e.target.value}}});return K(o),o})}},[a,j]),R=(0,o.useCallback)(function(t,e){return function(n){j(function(o){let r=structuredClone(o[a][t]),s=O(r,e);if(s>-1){r[s][n.target.name]=n.target.value;let e=d.HC.parse({...o,[a]:{...o[a],[t]:r}});return K(e),e}return o})}},[a,j]),B=(0,o.useCallback)(async function(t){var e;let a=new FileReader,n=await new Promise(function(e,n){a.onloadend=function(){e(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(t)}),o=(e=t.name,"https://api.github.com/repos/".concat("bnz","/").concat(r,"/contents/public/data/images/").concat(e)),c=await fetch(o,{method:"PUT",headers:{Authorization:"token ".concat(l),"Content-Type":"application/json"},body:JSON.stringify({message:"upload image ".concat(o.split("contents")[1]),content:n,branch:s})});if(!c.ok)throw Error("Failed to upload image");return(await c.json()).content.path.replace("public/","/")},[l]),X=(0,o.useCallback)(async function(){E((await (await fetch("https://api.github.com/repos/".concat("bnz","/").concat(r,"/contents/public/data/images"),{headers:{Authorization:"Bearer ".concat(l),Accept:"application/vnd.github.v3+json"}})).json()).map(function(t){let{name:e,path:a}=t;return{name:e,path:a.replace("public/","/")}}))},[l,E]),Y=(0,o.useCallback)(function(t,e){j(function(a){let n=structuredClone(a);g.U.forEach(function(a){let o=O(n[a][t],e);n[a][t].splice(o,1)});let o=d.HC.parse(n);return K(o),o})},[j,a]),$=(0,o.useCallback)(function(t,e){if(void 0!==e&&(t===d.Ki.features||t===d.Ki.posts||t===d.Ki.splits)){let n=O(C[a][t],e),o=O(y[a][t],e);return z()(C[a][t][n],y[a][t][o])}return z()(C[a][t],y[a][t])},[C,y,a]),G=(0,o.useCallback)(function(t,e,n){j(function(o){let r=structuredClone(o),s=O(r[a][t],e);r[a][t][s].image=n;let c=d.HC.parse(r);return K(c),c})},[j,a]);return(0,n.jsx)(k.Provider,{value:{loadFile:H,logOut:_,loadedData:y[a],setLoadedData:j,loadData:P,saveData:T,updateRecordData:q,updateArrayData:R,lang:a,publishLoading:A,setPublishLoading:J,uploadImage:B,loadImagesList:X,imagesList:F,removeFromArrayData:Y,saveToLocalStorage:K,areEqual:$,updateImage:G},children:(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)(v,{}):l?e:(0,n.jsx)(m,{})})})}function O(t,e){return t.findIndex(function(t){let{id:a}=t;return a===e})}},6048:(t,e,a)=>{a.d(e,{$n:()=>s,jl:()=>c,rm:()=>i});var n=a(5155),o=a(9300),r=a.n(o);function s(t){let{children:e,className:a,onClick:o,type:s="button",disabled:c}=t;return(0,n.jsx)("button",{className:r()("button",a),type:s,onClick:o,disabled:c,children:e})}function c(t){let{children:e,className:a,disabled:o}=t;return(0,n.jsx)(s,{type:"submit",className:a,disabled:o,children:e})}function i(t){let{children:e,className:a,onClick:o,disabled:s}=t;return(0,n.jsx)("button",{type:"button",className:r()("cursor-pointer",a),onClick:o,disabled:s,children:e})}},6099:(t,e,a)=>{a.d(e,{I18nProvider:()=>s,s:()=>c});var n=a(5155),o=a(2115);let r=(0,o.createContext)({keys:{},features:[],posts:[],splits:[]});function s(t){let{children:e,translations:a}=t;return(0,n.jsx)(r.Provider,{value:a,children:e})}function c(t){var e,a;let n=(0,o.useContext)(r);return"features"===t||"posts"===t?null!=(e=n[t])?e:"~".concat(t,"~"):null!=(a=n.keys[t])?a:"~".concat(t,"~")}}}]);